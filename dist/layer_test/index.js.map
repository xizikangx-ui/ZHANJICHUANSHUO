{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/util/script.ts","src://tavern_helper_template/util/common.ts","src://tavern_helper_template/util/streaming.ts","webpack://tavern_helper_template/util/iframe_srcdoc.html?0e55","src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.29_typescript@6.0.0-dev.20250807__webpack@5.105.3/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","webpack://tavern_helper_template/./src/layer_test/App.vue?cac6","webpack://tavern_helper_template/src/layer_test/App.vue?f0e9","src://tavern_helper_template/src/layer_test/index.ts"],"sourcesContent":["import iframe_srcdoc from './iframe_srcdoc.html';\n\nexport async function loadReadme(url: string): Promise<boolean> {\n  const readme = await fetch(url);\n  if (!readme.ok) {\n    return false;\n  }\n  const readme_text = await readme.text();\n  replaceScriptInfo(readme_text);\n  return true;\n}\n\nexport function teleportStyle(\n  append_to: JQuery.Selector | JQuery.htmlString | JQuery.TypeOrArray<Element | DocumentFragment> | JQuery = 'head',\n): { destroy: () => void } {\n  const $div = $(`<div>`)\n    .attr('script_id', getScriptId())\n    .append($(`head > style`, document).clone())\n    .appendTo(append_to);\n\n  return {\n    destroy: () => $div.remove(),\n  };\n}\n\nexport function createScriptIdIframe(): JQuery<HTMLIFrameElement> {\n  return $(`<iframe>`).attr({\n    script_id: getScriptId(),\n    frameborder: 0,\n    srcdoc: iframe_srcdoc,\n  }) as JQuery<HTMLIFrameElement>;\n}\n\nexport function createScriptIdDiv(): JQuery<HTMLDivElement> {\n  return $('<div>').attr('script_id', getScriptId()) as JQuery<HTMLDivElement>;\n}\n\nexport function reloadOnChatChange(): EventOnReturn {\n  let chat_id = SillyTavern.getCurrentChatId();\n  return eventOn(tavern_events.CHAT_CHANGED, new_chat_id => {\n    if (chat_id !== new_chat_id) {\n      chat_id = new_chat_id;\n      window.location.reload();\n    }\n  });\n}\n","import { compare } from 'compare-versions';\nimport JSON5 from 'json5';\nimport { jsonrepair } from 'jsonrepair';\nimport { toDotPath } from 'zod/v4/core';\n\nexport function assignInplace<T>(destination: T[], new_array: T[]): T[] {\n  destination.length = 0;\n  destination.push(...new_array);\n  return destination;\n}\n\n//  _.merge , [1, 2, 3]  [4, 5]  [4, 5]  [4, 5, 3]\nexport function correctlyMerge<TObject, TSource>(lhs: TObject, rhs: TSource): TObject & TSource {\n  return _.mergeWith(lhs, rhs, (_lhs, rhs) => (_.isArray(rhs) ? rhs : undefined));\n}\n\nexport function chunkBy<T>(array: T[], predicate: (lhs: T, rhs: T) => boolean): T[][] {\n  if (array.length === 0) {\n    return [];\n  }\n\n  const chunks: T[][] = [[array[0]]];\n  for (const [lhs, rhs] of _.zip(_.dropRight(array), _.drop(array))) {\n    if (predicate(lhs!, rhs!)) {\n      chunks[chunks.length - 1].push(rhs!);\n    } else {\n      chunks.push([rhs!]);\n    }\n  }\n  return chunks;\n}\n\nexport function regexFromString(input: string, replace_macros?: boolean): RegExp | null {\n  if (!input) {\n    return null;\n  }\n  const makeRegex = (pattern: string, flags: string) => {\n    if (replace_macros) {\n      pattern = substitudeMacros(pattern);\n    }\n    return new RegExp(pattern, flags);\n  };\n  try {\n    const match = input.match(/\\/(.+)\\/([a-z]*)/i);\n    if (!match) {\n      return makeRegex(_.escapeRegExp(input), 'i');\n    }\n    if (match[2] && !/^(?!.*?(.).*?\\1)[gmixXsuUAJ]+$/.test(match[3])) {\n      return makeRegex(input, 'i');\n    }\n    let flags = match[2] ?? '';\n    _.pull(flags, 'g');\n    if (flags.indexOf('i') === -1) {\n      flags = flags + 'i';\n    }\n    return makeRegex(match[1], flags);\n  } catch {\n    return null;\n  }\n}\n\nexport function uuidv4(): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    const r = (Math.random() * 16) | 0;\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\nexport async function checkMinimumVersion(expected: string, title: string) {\n  if (compare(await getTavernHelperVersion(), expected, '<')) {\n    toastr.error(`'${title}'  >= '${expected}'`, '');\n  }\n}\n\nexport function prettifyErrorWithInput(error: z.ZodError) {\n  return _([...error.issues])\n    .sortBy(issue => issue.path?.length ?? 0)\n    .flatMap(issue => {\n      const lines = [` ${issue.message}`];\n      if (issue.path?.length) {\n        lines.push(`   : ${toDotPath(issue.path)}`);\n      }\n      if (issue.input !== undefined) {\n        lines.push(`   : ${JSON.stringify(issue.input)}`);\n      }\n      return lines;\n    })\n    .join('\\n');\n}\n\nexport function literalYamlify(value: any) {\n  return YAML.stringify(value, { blockQuote: 'literal' });\n}\n\nexport function parseString(content: string): any {\n  let parsed: unknown;\n  try {\n    parsed = YAML.parseDocument(content, { merge: true }).toJS();\n  } catch (yaml_error) {\n    try {\n      // eslint-disable-next-line import-x/no-named-as-default-member\n      parsed = JSON5.parse(content);\n    } catch (json5_error) {\n      try {\n        parsed = JSON.parse(jsonrepair(content));\n      } catch (json_error) {\n        const toError = (error: unknown) => (error instanceof Error ? error.message : String(error));\n        throw new Error(\n          literalYamlify({\n            [' YAML/JSON ']: {\n              : content,\n              YAML: toError(yaml_error),\n              JSON5: toError(json5_error),\n              JSON: toError(json_error),\n            },\n          }),\n        );\n      }\n    }\n  }\n  return parsed;\n}\n","import { createScriptIdDiv, createScriptIdIframe, teleportStyle } from '@util/script';\nimport { uuidv4 } from './common';\nexport function injectStreamingMessageContext() {\n    return readonly(inject('streaming_message_context'));\n}\n/**\n * , .\n *\n * ,  `mes_streaming`  DOM:\n *   - `options.host==='iframe'`  iframe,  contentDocument.body \n *     - \n *     -  tailwindcss\n *   - `options.host==='div'`  div, \n *     - \n *     -  mes_text , \n *     -  tailwindcss, \n *     -  `@types/function/displayed_message.d.ts`  `formatAsDisplayedMessage` ,  `.replaceAll('mes_text', 'mes_streaming')` \n *\n * @param creator ,  `.use` \n * @param options \n *   - `host`: ,  `'iframe'`,  `'iframe'` , \n *   - `filter`: . , \n *   - `prefix`: , .  `prefix`,  `host` DOM  id  `${prefix}-${message_id}`.\n * @returns \n */\nexport function mountStreamingMessages(creator, options = {}) {\n    const { host = 'iframe', filter, prefix = uuidv4() } = options;\n    const states = new Map();\n    let has_stoped = false;\n    const destroyIfInvalid = (message_id) => {\n        const min_message_id = Number($('#chat > .mes').first().attr('mesid'));\n        if (!_.inRange(message_id, min_message_id, SillyTavern.chat.length)) {\n            states.get(message_id)?.destroy();\n            return true;\n        }\n        return false;\n    };\n    const destroyAllInvalid = () => {\n        states.keys().forEach(message_id => destroyIfInvalid(message_id));\n    };\n    const renderOneMessage = async (message_id, stream_message) => {\n        if (has_stoped) {\n            return;\n        }\n        if (destroyIfInvalid(message_id)) {\n            return;\n        }\n        const message = stream_message ?? getChatMessages(message_id)[0].message ?? '';\n        if (filter && !filter(message_id, message)) {\n            states.get(message_id)?.destroy();\n            return;\n        }\n        const $message_element = $(`.mes[mesid='${message_id}']`);\n        const $mes_text = $message_element.find('.mes_text').addClass('hidden!');\n        $message_element.find('.TH-streaming').addClass('hidden!');\n        let $host = $message_element.find(`#${prefix}-${message_id}`);\n        if ($host.length > 0) {\n            const state = states.get(message_id);\n            if (state) {\n                state.data.message = message;\n                state.data.during_streaming = Boolean(stream_message);\n                return;\n            }\n        }\n        states.get(message_id)?.destroy();\n        $host.remove();\n        let $mes_streaming = $message_element.find('.mes_streaming');\n        if ($mes_streaming.length === 0) {\n            $mes_streaming = $('<div class=\"mes_streaming\">')\n                .css({\n                'font-weight': '500',\n                'line-height': 'calc(var(--mainFontSize) + .5rem)',\n                'max-width': '100%',\n                'overflow-wrap': 'anywhere',\n                padding: 'calc(var(--mainFontSize) * 0.8) 0 0 0',\n            })\n                .insertAfter($mes_text);\n        }\n        $host = (host === 'iframe' ? createScriptIdIframe().addClass('w-full') : createScriptIdDiv())\n            .attr('id', `${prefix}-${message_id}`)\n            .appendTo($mes_streaming);\n        const data = reactive({\n            prefix,\n            host_id: `${prefix}-${message_id}`,\n            message_id,\n            message,\n            during_streaming: Boolean(stream_message),\n        });\n        const app = creator().provide('streaming_message_context', data);\n        if (host === 'iframe') {\n            $host.on('load', function () {\n                teleportStyle(this.contentDocument.head);\n                app.mount(this.contentDocument.body);\n            });\n        }\n        else {\n            app.mount($host[0]);\n        }\n        const observer = new MutationObserver(() => {\n            const $edit_textarea = $('#chat').find('#curEditTextarea');\n            if ($edit_textarea.parent().is($mes_text)) {\n                $mes_text.removeClass('hidden!');\n                $host.addClass('hidden!');\n            }\n            else if ($edit_textarea.length === 0) {\n                $mes_text.addClass('hidden!');\n                $message_element.find('.TH-streaming').addClass('hidden!');\n                $host.removeClass('hidden!');\n            }\n        });\n        observer.observe($mes_text[0], { childList: true });\n        states.set(message_id, {\n            app,\n            data,\n            destroy: () => {\n                const $th_streaming = $message_element.find('.TH-streaming');\n                if ($th_streaming.length > 0) {\n                    $th_streaming.removeClass('hidden!');\n                }\n                else {\n                    $mes_text.removeClass('hidden!');\n                }\n                app.unmount();\n                $host.remove();\n                if ($mes_streaming.children().length === 0) {\n                    $mes_streaming.remove();\n                }\n                observer.disconnect();\n                states.delete(message_id);\n            },\n        });\n    };\n    const renderAllMessage = async (options = {}) => {\n        if (has_stoped) {\n            return;\n        }\n        if (options.destroy_all) {\n            states.forEach(({ destroy }) => destroy());\n        }\n        else {\n            destroyAllInvalid();\n        }\n        await Promise.all($('#chat')\n            .children(\".mes[is_user='false'][is_system='false']\")\n            .map(async (_index, node) => {\n            const message_id = Number($(node).attr('mesid') ?? 'NaN');\n            if (!isNaN(message_id)) {\n                await renderOneMessage(message_id);\n                if (options.trigger_event) {\n                    eventEmit(tavern_events.CHARACTER_MESSAGE_RENDERED, message_id, 'rerender');\n                }\n            }\n        }));\n    };\n    const stop_list = [];\n    const scopedEventOn = (event, listener, first) => {\n        stop_list.push(first ? eventMakeFirst(event, errorCatched(listener)).stop : eventOn(event, errorCatched(listener)).stop);\n    };\n    scopedEventOn('chatLoaded', () => {\n        renderAllMessage({ destroy_all: true });\n    });\n    scopedEventOn(tavern_events.CHARACTER_MESSAGE_RENDERED, message_id => {\n        destroyAllInvalid();\n        renderOneMessage(message_id);\n    }, true);\n    [tavern_events.MESSAGE_EDITED, tavern_events.MESSAGE_DELETED].forEach(event => scopedEventOn(event, message_id => {\n        destroyAllInvalid();\n        states.get(message_id)?.destroy();\n        renderOneMessage(message_id);\n    }));\n    [tavern_events.MORE_MESSAGES_LOADED, tavern_events.MESSAGE_DELETED].forEach(event => scopedEventOn(event, () => setTimeout(errorCatched(renderAllMessage), 1000)));\n    scopedEventOn(tavern_events.STREAM_TOKEN_RECEIVED, message => {\n        renderOneMessage(Number($('#chat').children('.mes.last_mes').attr('mesid')), message);\n    });\n    if (host === 'div') {\n        stop_list.push(teleportStyle().destroy);\n    }\n    renderAllMessage({ trigger_event: true });\n    return {\n        unmount: () => {\n            const $th_streaming = $('#chat').find('.TH-streaming');\n            if ($th_streaming.length > 0) {\n                $th_streaming.removeClass('hidden!');\n            }\n            else {\n                $('chat').find('.mes_text').removeClass('hidden!');\n            }\n            states.forEach(({ destroy }) => destroy());\n            stop_list.forEach(stop => stop());\n            has_stoped = true;\n        },\n    };\n}\n","// Module\nvar code = `<!DOCTYPE html> <html> <head> <link rel=\"stylesheet\" href=\"https://testingcf.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css\"> ${\"<\" + \"script\"} src=\"https://testingcf.jsdelivr.net/gh/n0vi028/JS-Slash-Runner/lib/tailwindcss.min.js\">${\"<\" + \"/script\"}> ${\"<\" + \"script\"} src=\"https://testingcf.jsdelivr.net/npm/jquery\">${\"<\" + \"/script\"}> ${\"<\" + \"script\"} src=\"https://testingcf.jsdelivr.net/npm/jquery-ui/dist/jquery-ui.min.js\">${\"<\" + \"/script\"}> <link rel=\"stylesheet\" href=\"https://testingcf.jsdelivr.net/npm/jquery-ui/themes/base/theme.min.css\"/> ${\"<\" + \"script\"} src=\"https://testingcf.jsdelivr.net/npm/jquery-ui-touch-punch\">${\"<\" + \"/script\"}> ${\"<\" + \"script\"} src=\"https://testingcf.jsdelivr.net/npm/lodash\">${\"<\" + \"/script\"}> ${\"<\" + \"script\"} src=\"https://testingcf.jsdelivr.net/gh/n0vi028/JS-Slash-Runner/src/iframe/adjust_iframe_height.js\">${\"<\" + \"/script\"}> <style>*,::after,::before{box-sizing:border-box}body,html{margin:0!important;padding:0;overflow:hidden!important;max-width:100%!important}</style> </head> <html> </html></html>`;\n// Exports\nexport default code;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","module.exports = Vue;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, vModelSelect as _vModelSelect, isRef as _isRef, vModelCheckbox as _vModelCheckbox, normalizeClass as _normalizeClass, withModifiers as _withModifiers } from \"vue\";\n\nimport { computed, ref, reactive, inject, watch, onMounted, onUnmounted } from 'vue';\nconst _hoisted_1 = {\n    key: 0,\n    class: \"start-screen\"\n};\nconst _hoisted_2 = { class: \"start-card\" };\nconst _hoisted_3 = { class: \"start-card__mode\" };\nconst _hoisted_4 = { class: \"start-card__mode\" };\nconst _hoisted_5 = { class: \"start-card__mode\" };\nconst _hoisted_6 = { class: \"start-card__actions\" };\nconst _hoisted_7 = {\n    key: 1,\n    class: \"panel create-card\"\n};\nconst _hoisted_8 = [\"disabled\"];\nconst _hoisted_9 = [\"value\"];\nconst _hoisted_10 = {\n    key: 0,\n    class: \"xeno-box\"\n};\nconst _hoisted_11 = { class: \"desc-field\" };\nconst _hoisted_12 = [\"value\"];\nconst _hoisted_13 = [\"min\", \"max\"];\nconst _hoisted_14 = [\"disabled\"];\nconst _hoisted_15 = [\"value\"];\nconst _hoisted_16 = { key: 1 };\nconst _hoisted_17 = [\"value\"];\nconst _hoisted_18 = {\n    key: 2,\n    class: \"desc-field\"\n};\nconst _hoisted_19 = [\"value\"];\nconst _hoisted_20 = { class: \"row center-row\" };\nconst _hoisted_21 = {\n    key: 2,\n    class: \"panel create-card\"\n};\nconst _hoisted_22 = { class: \"hint\" };\nconst _hoisted_23 = { class: \"attr-list\" };\nconst _hoisted_24 = { class: \"attr-ctrl\" };\nconst _hoisted_25 = [\"disabled\", \"onClick\"];\nconst _hoisted_26 = [\"disabled\", \"onClick\"];\nconst _hoisted_27 = { class: \"row center-row\" };\nconst _hoisted_28 = {\n    key: 3,\n    class: \"panel create-card\"\n};\nconst _hoisted_29 = [\"value\"];\nconst _hoisted_30 = { class: \"row\" };\nconst _hoisted_31 = { class: \"hint\" };\nconst _hoisted_32 = { class: \"desc-field\" };\nconst _hoisted_33 = { class: \"hint\" };\nconst _hoisted_34 = { class: \"row center-row\" };\nconst _hoisted_35 = { class: \"topbar\" };\nconst _hoisted_36 = { class: \"controls\" };\nconst _hoisted_37 = { class: \"main-layout\" };\nconst _hoisted_38 = { class: \"panel player-sidebar\" };\nconst _hoisted_39 = { class: \"attr-card\" };\nconst _hoisted_40 = { class: \"resource-card\" };\nconst _hoisted_41 = { class: \"attr-chip\" };\nconst _hoisted_42 = { class: \"attr-chip\" };\nconst _hoisted_43 = { class: \"attr-chip\" };\nconst _hoisted_44 = { class: \"inventory-panel\" };\nconst _hoisted_45 = { class: \"row\" };\nconst _hoisted_46 = {\n    key: 0,\n    class: \"inventory-form\"\n};\nconst _hoisted_47 = {\n    key: 1,\n    class: \"hint\"\n};\nconst _hoisted_48 = [\"onClick\"];\nconst _hoisted_49 = {\n    key: 2,\n    class: \"hint\"\n};\nconst _hoisted_50 = { class: \"main-column\" };\nconst _hoisted_51 = { class: \"panel pager\" };\nconst _hoisted_52 = { class: \"row\" };\nconst _hoisted_53 = [\"disabled\"];\nconst _hoisted_54 = { class: \"hint\" };\nconst _hoisted_55 = [\"disabled\"];\nconst _hoisted_56 = { class: \"toggle\" };\nconst _hoisted_57 = {\n    key: 0,\n    class: \"panel settings\"\n};\nconst _hoisted_58 = { class: \"row\" };\nconst _hoisted_59 = { class: \"hint\" };\nconst _hoisted_60 = { class: \"toggle\" };\nconst _hoisted_61 = { id: \"th-model-options\" };\nconst _hoisted_62 = [\"value\"];\nconst _hoisted_63 = { class: \"row\" };\nconst _hoisted_64 = [\"disabled\"];\nconst _hoisted_65 = { class: \"hint\" };\nconst _hoisted_66 = { class: \"toggle\" };\nconst _hoisted_67 = { class: \"toggle\" };\nconst _hoisted_68 = { class: \"full\" };\nconst _hoisted_69 = { class: \"toggle\" };\nconst _hoisted_70 = { class: \"full\" };\nconst _hoisted_71 = { class: \"toggle\" };\nconst _hoisted_72 = { class: \"toggle\" };\nconst _hoisted_73 = { class: \"full\" };\nconst _hoisted_74 = { class: \"toggle\" };\nconst _hoisted_75 = { class: \"full\" };\nconst _hoisted_76 = { class: \"toggle\" };\nconst _hoisted_77 = [\"value\"];\nconst _hoisted_78 = { class: \"toggle\" };\nconst _hoisted_79 = { id: \"th-special-model-options\" };\nconst _hoisted_80 = [\"value\"];\nconst _hoisted_81 = { class: \"row\" };\nconst _hoisted_82 = [\"disabled\"];\nconst _hoisted_83 = { class: \"hint\" };\nconst _hoisted_84 = { class: \"full\" };\nconst _hoisted_85 = { class: \"toggle\" };\nconst _hoisted_86 = { class: \"full\" };\nconst _hoisted_87 = { class: \"row\" };\nconst _hoisted_88 = {\n    key: 1,\n    class: \"panel memory-vault\"\n};\nconst _hoisted_89 = { class: \"row\" };\nconst _hoisted_90 = { class: \"hint\" };\nconst _hoisted_91 = { class: \"row\" };\nconst _hoisted_92 = [\"disabled\"];\nconst _hoisted_93 = [\"disabled\"];\nconst _hoisted_94 = { class: \"hint\" };\nconst _hoisted_95 = {\n    key: 0,\n    class: \"hint\"\n};\nconst _hoisted_96 = { class: \"row\" };\nconst _hoisted_97 = { class: \"hint\" };\nconst _hoisted_98 = { class: \"hint\" };\nconst _hoisted_99 = { class: \"panel quick\" };\nconst _hoisted_100 = [\"disabled\"];\nconst _hoisted_101 = [\"disabled\"];\nconst _hoisted_102 = [\"disabled\"];\nconst _hoisted_103 = { class: \"panel chat\" };\nconst _hoisted_104 = { class: \"messages\" };\nconst _hoisted_105 = [\"disabled\"];\nconst _hoisted_106 = { class: \"row\" };\nconst _hoisted_107 = { class: \"hint\" };\nconst _hoisted_108 = [\"disabled\"];\nconst _hoisted_109 = { class: \"panel npc-panel\" };\nconst _hoisted_110 = { class: \"row\" };\nconst _hoisted_111 = { class: \"hint\" };\nconst _hoisted_112 = { class: \"npc-form\" };\nconst _hoisted_113 = { class: \"toggle\" };\nconst _hoisted_114 = { class: \"npc-columns\" };\nconst _hoisted_115 = [\"onClick\"];\nconst _hoisted_116 = {\n    key: 0,\n    class: \"hint\"\n};\nconst _hoisted_117 = [\"onClick\"];\nconst _hoisted_118 = {\n    key: 0,\n    class: \"hint\"\n};\nconst _hoisted_119 = { class: \"row\" };\nconst _hoisted_120 = { class: \"hint\" };\nconst _hoisted_121 = [\"disabled\"];\nconst _hoisted_122 = { key: 0 };\nconst _hoisted_123 = { class: \"hint\" };\nconst _hoisted_124 = {\n    key: 0,\n    class: \"hint\"\n};\nconst _hoisted_125 = {\n    key: 5,\n    class: \"system-float\"\n};\nconst _hoisted_126 = {\n    key: 0,\n    class: \"system-notice db-notice\"\n};\nconst _hoisted_127 = { key: 0 };\nconst _hoisted_128 = { key: 1 };\nconst _hoisted_129 = [\"onClick\"];\nconst storageKey = 'th-layer-test-api-settings-v3';\nconst runtimeStorageKey = 'th-layer-test-memory-runtime-v1';\nconst normalOpeningStory = `177828\n\n\n\n\n\n\n......`;\nconst xenoOpeningStory = ` / 177828\\n\\n\\n\\n`;\nconst humanPointsTotal = 5;\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    props: {\n        mode: { default: 'standalone' }\n    },\n    setup(__props) {\n        const props = __props;\n        const modeHint = computed(() => (props.mode === 'embedded' ? '' : ''));\n        const inTavern = computed(() => typeof window.SillyTavern !== 'undefined');\n        const rootRef = ref(null);\n        const isFullscreen = ref(false);\n        const started = ref(false);\n        const createDone = ref(false);\n        const createPage = ref(1);\n        const cheatMode = ref(false);\n        const plotMode = ref(true);\n        const xenoRouteMode = ref(false);\n        const xenoRouteRole = ref('');\n        const showSettings = ref(true);\n        const showSummaryCenter = ref(false);\n        const showInventoryPanel = ref(true);\n        const showNpcPanel = ref(true);\n        const pending = ref(false);\n        const dbLock = ref(false);\n        const draft = ref('');\n        const nextId = ref(1);\n        const currentPage = ref(0);\n        const tavernSummary = ref('');\n        const systemNotices = ref([]);\n        const dbTask = reactive({\n            active: false,\n            completed: false,\n            label: '',\n            seconds: 0,\n        });\n        const professionOptions = ['', '', ''];\n        const warmaidTypeOptions = ['', '', '', '', '', ''];\n        const genderOptions = ['', '', '', '', '', ''];\n        const ageLimits = {\n            : { min: 12, max: 18 },\n            : { min: 21, max: 70 },\n            : { min: 14, max: 80 },\n        };\n        const professionDescriptionMap = {\n            : `\n\n\n\n\n1000\n\n\n\n12-18`,\n            : `\n/\n\n:X\n:X\n:1D6\n:1D6\n:X\n:X\n\n\n\t\n11\n`,\n            : `\n\n\n\n\n\n\n`,\n        };\n        const warmaidTypeDescriptionMap = {\n            : `:\n:\n  : 1\n  : 2`,\n            : `\n/\n\n:4D6\n:3D6\n:3D6\n:3D6\n:5D6\n:2D6\n2/\n21`,\n            : `\n/\n\n:4D6\n:4D6\n:3D6\n:5D6\n:4D6\n:3D8\n3\n11`,\n            : `\n/\n\n:4D6\n:6D6\n:5D6\n:6D6\n:3D5\n:4D8\n4\n11`,\n            : `\n//\n\n:4D6\n:10D6\n:7D6\n:10D6\n:1D2\n:7D10\n6\n1`,\n            : `\n/\n\n:4d6\n:5d6\n:4D6\n:10D6\n:1d1\n:4d12\n2\n11`,\n        };\n        const createForm = reactive({\n            name: '',\n            profession: '',\n            warmaidType: '',\n            age: 12,\n            gender: '',\n            background: '',\n        });\n        const backgroundTemplateMap = {\n            : `\n\n`,\n            : `\n\n`,\n            : `\n\n`,\n            : `\n\n`,\n            : `\n\n`,\n        };\n        const backgroundPresetOptions = [\n            { key: '', label: '' },\n            { key: '', label: '' },\n            { key: '', label: '' },\n            { key: '', label: '' },\n            { key: '', label: '' },\n        ];\n        const backgroundPresetKey = ref('');\n        const humanAttrItems = [\n            { key: '', desc: '' },\n            { key: '', desc: '' },\n            { key: '', desc: '' },\n            { key: '', desc: '' },\n            { key: '', desc: '' },\n            { key: '', desc: '' },\n            { key: '', desc: '' },\n        ];\n        const createHumanAttr = reactive({\n            : 1,\n            : 1,\n            : 1,\n            : 1,\n            : 1,\n            : 1,\n            : 1,\n        });\n        const humanPointsLeft = computed(() => humanPointsTotal - Object.values(createHumanAttr).reduce((sum, v) => sum + Number(v || 0), 0) + 7);\n        const currentAgeRange = computed(() => ageLimits[createForm.profession]);\n        const professionDescription = computed(() => professionDescriptionMap[createForm.profession]);\n        const warmaidTypeDescription = computed(() => {\n            if (createForm.warmaidType === '')\n                createForm.warmaidType = '';\n            const key = createForm.warmaidType === ''\n                ? ''\n                : createForm.warmaidType === ''\n                    ? ''\n                    : createForm.warmaidType;\n            return warmaidTypeDescriptionMap[key] ?? '';\n        });\n        const autoBackgroundPresetKey = computed(() => (xenoRouteMode.value ? xenoRouteRole.value : createForm.profession));\n        const currentBackgroundPresetLabel = computed(() => backgroundPresetOptions.find(item => item.key === backgroundPresetKey.value)?.label || '');\n        const backgroundSummary = computed(() => {\n            const raw = (createForm.background || '').replace(/\\s+/g, ' ').trim();\n            if (!raw)\n                return '';\n            return raw.length > 220 ? `${raw.slice(0, 220)}...` : raw;\n        });\n        const getInitialResourceByBuild = () => {\n            if (xenoRouteMode.value) {\n                if (xenoRouteRole.value === '') {\n                    return { hpMax: 130, mpMax: 140, ap: 1 };\n                }\n                return { hpMax: 110, mpMax: 130, ap: 1 };\n            }\n            if (createForm.profession === '') {\n                const apByType = {\n                    : 1,\n                    : 2,\n                    : 1,\n                    : 1,\n                    : 1,\n                    : 1,\n                };\n                return { hpMax: 120, mpMax: 120, ap: apByType[createForm.warmaidType] ?? 1 };\n            }\n            if (createForm.profession === '')\n                return { hpMax: 100, mpMax: 100, ap: 1 };\n            return { hpMax: 100, mpMax: 110, ap: 1 };\n        };\n        const resetPlayerResource = () => {\n            const base = getInitialResourceByBuild();\n            playerResource.hpMax = base.hpMax;\n            playerResource.hp = base.hpMax;\n            playerResource.mpMax = base.mpMax;\n            playerResource.mp = base.mpMax;\n            playerResource.ap = base.ap;\n        };\n        const defaultSettings = {\n            autoFlipPage: true,\n            useTavernPreset: true,\n            baseUrl: 'https://api.openai.com/v1',\n            apiKey: '',\n            model: 'gpt-4.1-mini',\n            systemPrompt: '',\n            autoSummaryEnabled: true,\n            summaryFloorsPerRun: 5,\n            summaryUseCurrentApi: true,\n            autoSummaryPrompt: '/',\n            summaryUseVarApi: false,\n            summaryVarApiUrl: '',\n            summaryVarApiKey: '',\n            summaryVarApiPayload: '{\"scope\":\"layer_memory\",\"need\":[\"world_state\",\"route_state\",\"flags\"]}',\n            megaSummaryEnabled: true,\n            megaSummaryEvery: 5,\n            megaSummaryUseCurrentApi: true,\n            megaSummaryPrompt: '',\n            megaSummaryUseVarApi: false,\n            megaSummaryVarApiUrl: '',\n            megaSummaryVarApiKey: '',\n            megaSummaryVarApiPayload: '{\"scope\":\"mega_memory\",\"need\":[\"global_flags\",\"chapter_progress\"]}',\n            specialMemoryEnabled: false,\n            specialMemoryNpcId: 0,\n            specialMemoryUseCurrentApi: true,\n            specialMemoryBaseUrl: '',\n            specialMemoryApiKey: '',\n            specialMemoryModel: '',\n            specialMemoryPrompt: 'NPCNPC//',\n            specialMemoryUseVarApi: false,\n            specialMemoryVarApiUrl: '',\n            specialMemoryVarApiKey: '',\n            specialMemoryVarApiPayload: '{\"scope\":\"special_npc\",\"need\":[\"npc_state\",\"world_state\",\"recent_flags\"]}',\n        };\n        const settings = reactive({ ...defaultSettings });\n        const modelOptions = ref([]);\n        const modelFetchRunning = ref(false);\n        const specialModelOptions = ref([]);\n        const specialModelFetchRunning = ref(false);\n        const memoryVault = ref([]);\n        const megaMemoryVault = ref([]);\n        const onstageNpcs = ref([]);\n        const longtermNpcs = ref([]);\n        const inventoryItems = ref([]);\n        const npcAutoActions = ref([]);\n        const specialNpcRunning = ref(false);\n        const npcAutoPanelCollapsed = ref(true);\n        const npcEditor = reactive({\n            name: '',\n            role: '',\n            relation: '',\n            status: '',\n            tags: '',\n            toLongterm: false,\n        });\n        const inventoryEditor = reactive({\n            name: '',\n            count: 1,\n            note: '',\n        });\n        const summaryRunning = ref(false);\n        const summaryLastFloor = ref(0);\n        const hiddenFloorUntil = ref(0);\n        const megaSummaryLastCount = ref(0);\n        const lockHint = computed(() => {\n            if (dbLock.value || summaryRunning.value)\n                return '...';\n            if (pending.value)\n                return 'AI ...';\n            return modeHint.value;\n        });\n        const interactionLocked = computed(() => pending.value || summaryRunning.value || dbLock.value);\n        const injectedContext = inject('streaming_message_context', null);\n        const contextHint = computed(() => {\n            if (!injectedContext)\n                return '';\n            return `\\n\\n[] ID: ${injectedContext.message_id}\\n[]\\n${injectedContext.message ?? ''}`;\n        });\n        const playerBuildHint = computed(() => {\n            const attrs = humanAttrItems.map(item => `${item.key}:${createHumanAttr[item.key]}`).join(' / ');\n            const route = xenoRouteMode.value ? `(${xenoRouteRole.value})` : '';\n            const mode = cheatMode.value ? '' : '';\n            return [\n                `[] =${createForm.name || ''} | =${createForm.gender} | =${createForm.profession} | =${createForm.age}`,\n                `[] =${route} | =${mode}`,\n                `[] =${plotMode.value ? '' : ''} | =${plotMode.value ? '__PLOT_ON__' : '__PLOT_OFF__'}`,\n                `[] =${attrs}`,\n                `[] =${playerResource.hp}/${playerResource.hpMax} ${playerResource.mp}/${playerResource.mpMax} ${playerResource.ap}`,\n                `[] =${createForm.background || ''}`,\n                `[] =${backgroundSummary.value}`,\n                plotMode.value\n                    ? '[] '\n                    : '[] ',\n                xenoRouteMode.value\n                    ? '[] '\n                    : '[] ',\n            ].join('\\n');\n        });\n        const memoryVaultHint = computed(() => {\n            if (!memoryVault.value.length)\n                return '';\n            const lines = memoryVault.value.map(item => `- ${item.floorStart}-${item.floorEnd}: ${item.summary}`);\n            return `[]\\n${lines.join('\\n')}`;\n        });\n        const memoryVaultReversed = computed(() => [...memoryVault.value].reverse());\n        const megaMemoryVaultReversed = computed(() => [...megaMemoryVault.value].reverse());\n        const npcAutoActionsReversed = computed(() => [...npcAutoActions.value].reverse());\n        const allNpcs = computed(() => [...onstageNpcs.value, ...longtermNpcs.value]);\n        const selectedSpecialMemoryNpc = computed(() => {\n            const id = Number(settings.specialMemoryNpcId) || 0;\n            if (!id)\n                return null;\n            return allNpcs.value.find(n => n.id === id) ?? null;\n        });\n        const messages = ref([{ id: nextId.value++, role: 'assistant', content: '' }]);\n        const playerResource = reactive({\n            hp: 100,\n            hpMax: 100,\n            mp: 100,\n            mpMax: 100,\n            ap: 1,\n        });\n        const roleLabel = (role) => (role === 'user' ? '' : role === 'assistant' ? 'AI' : role === 'error' ? '' : '');\n        const pushMessage = (role, content) => messages.value.push({ id: nextId.value++, role, content });\n        const sanitizeAssistantContent = (content) => {\n            const raw = String(content ?? '');\n            const rawTrimmed = raw.trim();\n            const normalizedRaw = raw\n                .replace(/&lt;\\/?think\\b[^&]*&gt;/gim, m => m.replace('&lt;', '<').replace('&gt;', '>'))\n                .replace(/&lt;\\/?thinking\\b[^&]*&gt;/gim, m => m.replace('&lt;', '<').replace('&gt;', '>'))\n                .replace(/&lt;\\/?reasoning\\b[^&]*&gt;/gim, m => m.replace('&lt;', '<').replace('&gt;', '>'))\n                .replace(/&lt;\\/?content&gt;/gim, m => m.replace('&lt;', '<').replace('&gt;', '>'));\n            // If a stray </think> leaks into output, keep only the tail text.\n            const tailAfterThink = normalizedRaw.includes('</think>')\n                ? normalizedRaw.split('</think>').pop() ?? normalizedRaw\n                : normalizedRaw;\n            const contentMatch = tailAfterThink.match(/<content>([\\s\\S]*?)<\\/content>/im);\n            const source = contentMatch?.[1] ?? tailAfterThink;\n            const cleaned = source\n                .replace(/<think[\\s\\S]*?<\\/think>/gim, '')\n                .replace(/<Thought[\\s\\S]*?<\\/Thought>/gim, '')\n                .replace(/<thinking[\\s\\S]*?<\\/thinking>/gim, '')\n                .replace(/<reasoning[\\s\\S]*?<\\/reasoning>/gim, '')\n                .replace(/```(?:think|thinking|reasoning|cot)[\\s\\S]*?```/gim, '')\n                .replace(/<(think|Thought|thinking|reasoning)\\b[^>]*>[\\s\\S]*$/gim, '')\n                .replace(/<\\/?content>/gim, '')\n                .trim();\n            const cleanedFallback = tailAfterThink\n                .replace(/<\\/?content>/gim, '')\n                .replace(/<(think|Thought|thinking|reasoning)\\b[^>]*>/gim, '')\n                .trim();\n            if (cleaned)\n                return cleaned;\n            if (cleanedFallback)\n                return cleanedFallback;\n            if (/<(think|Thought|thinking|reasoning)\\b|```(?:think|thinking|reasoning|cot)/i.test(raw))\n                return '';\n            return rawTrimmed;\n        };\n        const displayContent = (item) => (item.role === 'assistant' ? sanitizeAssistantContent(item.content) : item.content);\n        const dismissNotice = (id) => {\n            systemNotices.value = systemNotices.value.filter(n => n.id !== id);\n        };\n        const pushSystemNotice = (content) => {\n            const id = Date.now() + Math.floor(Math.random() * 10000);\n            systemNotices.value.unshift({ id, content });\n            systemNotices.value = systemNotices.value.slice(0, 4);\n            toastr.info(content, '');\n            setTimeout(() => dismissNotice(id), 12000);\n        };\n        let dbTickTimer = null;\n        const startDbTask = (label) => {\n            dbTask.active = true;\n            dbTask.completed = false;\n            dbTask.label = label;\n            dbTask.seconds = 0;\n            dbLock.value = true;\n            if (dbTickTimer)\n                clearInterval(dbTickTimer);\n            dbTickTimer = setInterval(() => {\n                dbTask.seconds += 1;\n            }, 1000);\n        };\n        const finishDbTask = () => {\n            if (dbTickTimer) {\n                clearInterval(dbTickTimer);\n                dbTickTimer = null;\n            }\n            dbTask.completed = true;\n            dbLock.value = false;\n            setTimeout(() => {\n                dbTask.active = false;\n                dbTask.completed = false;\n                dbTask.label = '';\n                dbTask.seconds = 0;\n            }, 1500);\n        };\n        const pageRanges = computed(() => {\n            const starts = [0];\n            for (let i = 1; i < messages.value.length; i++) {\n                if (messages.value[i]?.role === 'user')\n                    starts.push(i);\n            }\n            return starts.map((start, idx) => ({ start, end: starts[idx + 1] ?? messages.value.length }));\n        });\n        const visibleMessages = computed(() => {\n            const page = pageRanges.value[currentPage.value];\n            const source = page ? messages.value.slice(page.start, page.end) : messages.value;\n            return source.filter(item => item.role !== 'system');\n        });\n        watch(() => messages.value.length, () => {\n            if (pageRanges.value.length && settings.autoFlipPage)\n                currentPage.value = pageRanges.value.length - 1;\n        });\n        watch(() => createForm.profession, profession => {\n            const range = ageLimits[profession];\n            if (!cheatMode.value) {\n                if (createForm.age < range.min)\n                    createForm.age = range.min;\n                if (createForm.age > range.max)\n                    createForm.age = range.max;\n            }\n            if (profession === '')\n                createForm.gender = '';\n        }, { immediate: true });\n        watch(() => xenoRouteRole.value, () => {\n            if (!xenoRouteMode.value)\n                return;\n            if (xenoRouteRole.value === '') {\n                createForm.profession = '';\n                createForm.gender = '';\n                if (!cheatMode.value) {\n                    if (createForm.age < 12)\n                        createForm.age = 12;\n                    if (createForm.age > 18)\n                        createForm.age = 18;\n                }\n                return;\n            }\n            createForm.profession = '';\n            if (!cheatMode.value) {\n                if (createForm.age < 21)\n                    createForm.age = 21;\n                if (createForm.age > 70)\n                    createForm.age = 70;\n            }\n        });\n        watch(() => autoBackgroundPresetKey.value, key => {\n            backgroundPresetKey.value = key;\n        }, { immediate: true });\n        watch(() => createForm.background, value => {\n            if ((value || '').length > 1000)\n                createForm.background = value.slice(0, 1000);\n        });\n        watch(settings, () => {\n            localStorage.setItem(storageKey, JSON.stringify({ ...settings }));\n        }, { deep: true });\n        watch(allNpcs, npcs => {\n            const id = Number(settings.specialMemoryNpcId) || 0;\n            if (!id)\n                return;\n            if (!npcs.some(n => n.id === id))\n                settings.specialMemoryNpcId = 0;\n        }, { deep: true });\n        watch([\n            memoryVault,\n            megaMemoryVault,\n            onstageNpcs,\n            longtermNpcs,\n            inventoryItems,\n            npcAutoActions,\n            npcAutoPanelCollapsed,\n            () => ({ ...playerResource }),\n            summaryLastFloor,\n            hiddenFloorUntil,\n            megaSummaryLastCount,\n        ], () => {\n            saveRuntimeState();\n        }, { deep: true });\n        const saveSettings = () => {\n            localStorage.setItem(storageKey, JSON.stringify({ ...settings }));\n            pushSystemNotice('');\n        };\n        const saveRuntimeState = () => {\n            localStorage.setItem(runtimeStorageKey, JSON.stringify({\n                memoryVault: memoryVault.value,\n                megaMemoryVault: megaMemoryVault.value,\n                onstageNpcs: onstageNpcs.value,\n                longtermNpcs: longtermNpcs.value,\n                inventoryItems: inventoryItems.value,\n                npcAutoActions: npcAutoActions.value,\n                npcAutoPanelCollapsed: npcAutoPanelCollapsed.value,\n                playerResource: { ...playerResource },\n                summaryLastFloor: summaryLastFloor.value,\n                hiddenFloorUntil: hiddenFloorUntil.value,\n                megaSummaryLastCount: megaSummaryLastCount.value,\n            }));\n        };\n        const loadSettings = () => {\n            const raw = localStorage.getItem(storageKey);\n            if (!raw)\n                return;\n            try {\n                Object.assign(settings, defaultSettings, JSON.parse(raw) ?? {});\n            }\n            catch {\n                Object.assign(settings, defaultSettings);\n            }\n        };\n        const loadRuntimeState = () => {\n            const raw = localStorage.getItem(runtimeStorageKey);\n            if (!raw)\n                return;\n            try {\n                const parsed = JSON.parse(raw) ?? {};\n                memoryVault.value = Array.isArray(parsed.memoryVault) ? parsed.memoryVault : [];\n                megaMemoryVault.value = Array.isArray(parsed.megaMemoryVault) ? parsed.megaMemoryVault : [];\n                onstageNpcs.value = Array.isArray(parsed.onstageNpcs) ? parsed.onstageNpcs : [];\n                longtermNpcs.value = Array.isArray(parsed.longtermNpcs) ? parsed.longtermNpcs : [];\n                inventoryItems.value = Array.isArray(parsed.inventoryItems) ? parsed.inventoryItems : [];\n                npcAutoActions.value = Array.isArray(parsed.npcAutoActions) ? parsed.npcAutoActions : [];\n                npcAutoPanelCollapsed.value = parsed.npcAutoPanelCollapsed !== false;\n                Object.assign(playerResource, parsed.playerResource ?? {});\n                playerResource.hpMax = Math.max(1, Number(playerResource.hpMax) || 100);\n                playerResource.mpMax = Math.max(1, Number(playerResource.mpMax) || 100);\n                playerResource.hp = Math.max(0, Math.min(playerResource.hpMax, Number(playerResource.hp) || playerResource.hpMax));\n                playerResource.mp = Math.max(0, Math.min(playerResource.mpMax, Number(playerResource.mp) || playerResource.mpMax));\n                playerResource.ap = Math.max(0, Math.min(9, Number(playerResource.ap) || 1));\n                summaryLastFloor.value = Number(parsed.summaryLastFloor) || 0;\n                hiddenFloorUntil.value = Number(parsed.hiddenFloorUntil) || 0;\n                megaSummaryLastCount.value = Number(parsed.megaSummaryLastCount) || 0;\n            }\n            catch {\n                memoryVault.value = [];\n                megaMemoryVault.value = [];\n                onstageNpcs.value = [];\n                longtermNpcs.value = [];\n                inventoryItems.value = [];\n                npcAutoActions.value = [];\n                npcAutoPanelCollapsed.value = true;\n                resetPlayerResource();\n                summaryLastFloor.value = 0;\n                hiddenFloorUntil.value = 0;\n                megaSummaryLastCount.value = 0;\n            }\n        };\n        const resetSession = () => {\n            messages.value = [{ id: 1, role: 'assistant', content: '' }];\n            nextId.value = 2;\n            currentPage.value = 0;\n            memoryVault.value = [];\n            megaMemoryVault.value = [];\n            onstageNpcs.value = [];\n            longtermNpcs.value = [];\n            inventoryItems.value = [];\n            npcAutoActions.value = [];\n            resetPlayerResource();\n            summaryLastFloor.value = 0;\n            hiddenFloorUntil.value = 0;\n            megaSummaryLastCount.value = 0;\n            saveRuntimeState();\n        };\n        const pickString = (source, keys) => {\n            for (const key of keys) {\n                const value = source?.[key];\n                if (typeof value === 'string' && value.trim())\n                    return value.trim();\n            }\n            return '';\n        };\n        const pullFromTavern = () => {\n            if (!inTavern.value) {\n                tavernSummary.value = '';\n                pushMessage('error', '');\n                return;\n            }\n            try {\n                const st = window.SillyTavern;\n                const presetName = typeof getLoadedPresetName === 'function' ? getLoadedPresetName() : '';\n                const preset = typeof getPreset === 'function' ? getPreset('in_use') : null;\n                const chatConfig = st?.chatCompletionSettings ?? {};\n                settings.model = (typeof st?.getChatCompletionModel === 'function' ? st.getChatCompletionModel() : '') || settings.model;\n                settings.baseUrl = pickString(chatConfig, ['api_url', 'apiUrl', 'reverse_proxy', 'proxy_url', 'custom_url']) || settings.baseUrl;\n                settings.apiKey = pickString(chatConfig, ['api_key', 'apiKey', 'reverse_proxy_password']) || settings.apiKey;\n                settings.useTavernPreset = true;\n                if (preset?.settings?.should_stream === false) {\n                    pushSystemNotice('');\n                }\n                tavernSummary.value = presetName ? `: ${presetName}` : '';\n                pushSystemNotice(`${presetName ? `: ${presetName}` : ''}`);\n                saveSettings();\n            }\n            catch (error) {\n                tavernSummary.value = '';\n                pushMessage('error', `: ${error?.message ?? String(error)}`);\n            }\n        };\n        const buildApiUrl = (baseUrl) => {\n            const cleaned = baseUrl.trim().replace(/\\/+$/, '');\n            return cleaned.endsWith('/chat/completions') ? cleaned : `${cleaned}/chat/completions`;\n        };\n        const buildModelsUrl = (baseUrl) => {\n            const cleaned = baseUrl.trim().replace(/\\/+$/, '');\n            if (!cleaned)\n                return '';\n            if (/\\/chat\\/completions$/i.test(cleaned))\n                return cleaned.replace(/\\/chat\\/completions$/i, '/models');\n            if (/\\/models$/i.test(cleaned))\n                return cleaned;\n            return `${cleaned}/models`;\n        };\n        const extractModelIds = (payload) => {\n            const rawList = Array.isArray(payload)\n                ? payload\n                : Array.isArray(payload?.data)\n                    ? payload.data\n                    : Array.isArray(payload?.models)\n                        ? payload.models\n                        : [];\n            const ids = rawList\n                .map((item) => {\n                if (typeof item === 'string')\n                    return item.trim();\n                if (item && typeof item.id === 'string')\n                    return item.id.trim();\n                if (item && typeof item.name === 'string')\n                    return item.name.trim();\n                return '';\n            })\n                .filter(Boolean);\n            return Array.from(new Set(ids)).sort((a, b) => a.localeCompare(b, 'zh-Hans-CN'));\n        };\n        const fetchModelOptions = async () => {\n            const url = buildModelsUrl(settings.baseUrl);\n            if (!url) {\n                pushSystemNotice(' Base URL');\n                return;\n            }\n            modelFetchRunning.value = true;\n            try {\n                const headers = {};\n                if (settings.apiKey?.trim())\n                    headers.Authorization = `Bearer ${settings.apiKey.trim()}`;\n                const response = await fetch(url, { method: 'GET', headers });\n                if (!response.ok)\n                    throw new Error(`HTTP ${response.status}`);\n                const data = await response.json();\n                const ids = extractModelIds(data);\n                if (!ids.length)\n                    throw new Error('');\n                modelOptions.value = ids;\n                if (!settings.model || !ids.includes(settings.model))\n                    settings.model = ids[0];\n                pushSystemNotice(` ${ids.length} `);\n                saveSettings();\n            }\n            catch (error) {\n                pushMessage('error', `: ${error?.message ?? String(error)}`);\n            }\n            finally {\n                modelFetchRunning.value = false;\n            }\n        };\n        const fetchSpecialModelOptions = async () => {\n            const url = buildModelsUrl(settings.specialMemoryBaseUrl);\n            if (!url) {\n                pushSystemNotice('NPC Base URL');\n                return;\n            }\n            specialModelFetchRunning.value = true;\n            try {\n                const headers = {};\n                if (settings.specialMemoryApiKey?.trim())\n                    headers.Authorization = `Bearer ${settings.specialMemoryApiKey.trim()}`;\n                const response = await fetch(url, { method: 'GET', headers });\n                if (!response.ok)\n                    throw new Error(`HTTP ${response.status}`);\n                const data = await response.json();\n                const ids = extractModelIds(data);\n                if (!ids.length)\n                    throw new Error('');\n                specialModelOptions.value = ids;\n                if (!settings.specialMemoryModel || !ids.includes(settings.specialMemoryModel))\n                    settings.specialMemoryModel = ids[0];\n                pushSystemNotice(`NPC ${ids.length} `);\n                saveSettings();\n            }\n            catch (error) {\n                pushMessage('error', `NPC: ${error?.message ?? String(error)}`);\n            }\n            finally {\n                specialModelFetchRunning.value = false;\n            }\n        };\n        const buildPayloadMessages = () => {\n            const payload = [];\n            const systemBlocks = [settings.systemPrompt, playerBuildHint.value];\n            if (memoryVaultHint.value)\n                systemBlocks.push(memoryVaultHint.value);\n            if (contextHint.value)\n                systemBlocks.push(contextHint.value);\n            if (hiddenFloorUntil.value > 0) {\n                systemBlocks.push(`[]  1-${hiddenFloorUntil.value}`);\n            }\n            payload.push({ role: 'system', content: systemBlocks.filter(Boolean).join('\\n\\n') });\n            for (const [idx, range] of pageRanges.value.entries()) {\n                if (idx > 0 && idx <= hiddenFloorUntil.value)\n                    continue;\n                const slice = messages.value.slice(range.start, range.end);\n                for (const item of slice) {\n                    if (item.role === 'user' || item.role === 'assistant')\n                        payload.push({ role: item.role, content: item.content });\n                }\n            }\n            return payload;\n        };\n        const extractAssistantText = (raw) => {\n            const text = sanitizeAssistantContent(raw).trim();\n            return text || '[]';\n        };\n        const buildFloorTranscript = (floorStart, floorEnd) => {\n            const lines = [];\n            for (let floor = floorStart; floor <= floorEnd; floor++) {\n                const range = pageRanges.value[floor];\n                if (!range)\n                    continue;\n                const slice = messages.value.slice(range.start, range.end);\n                lines.push(`###  ${floor}`);\n                for (const item of slice) {\n                    if (item.role === 'user')\n                        lines.push(`: ${item.content}`);\n                    if (item.role === 'assistant')\n                        lines.push(`AI: ${extractAssistantText(item.content)}`);\n                }\n            }\n            return lines.join('\\n');\n        };\n        const fetchExtraVariablesByConfig = async (options) => {\n            if (!options.useVarApi || !options.url.trim())\n                return '';\n            const headers = { 'Content-Type': 'application/json' };\n            if (options.key.trim())\n                headers.Authorization = `Bearer ${options.key.trim()}`;\n            const bodyText = options.payload.trim();\n            const method = bodyText ? 'POST' : 'GET';\n            const response = await fetch(options.url.trim(), {\n                method,\n                headers,\n                body: method === 'POST' ? bodyText : undefined,\n            });\n            if (!response.ok)\n                throw new Error(`API: HTTP ${response.status}`);\n            const text = await response.text();\n            return text.length > 5000 ? `${text.slice(0, 5000)}\\n...()` : text;\n        };\n        const requestTextByManualApi = async (userPrompt) => {\n            if (!settings.baseUrl || !settings.model)\n                throw new Error(' Base URL  Model');\n            const headers = { 'Content-Type': 'application/json' };\n            if (settings.apiKey)\n                headers.Authorization = `Bearer ${settings.apiKey}`;\n            const response = await fetch(buildApiUrl(settings.baseUrl), {\n                method: 'POST',\n                headers,\n                body: JSON.stringify({\n                    model: settings.model,\n                    stream: false,\n                    messages: [\n                        { role: 'system', content: '' },\n                        { role: 'user', content: userPrompt },\n                    ],\n                }),\n            });\n            if (!response.ok)\n                throw new Error(`: HTTP ${response.status}`);\n            const data = await response.json();\n            return String(data?.choices?.[0]?.message?.content ?? '').trim();\n        };\n        const requestTextByApiConfig = async (options, userPrompt) => {\n            if (!options.baseUrl || !options.model)\n                throw new Error(' Base URL  Model');\n            const headers = { 'Content-Type': 'application/json' };\n            if (options.apiKey)\n                headers.Authorization = `Bearer ${options.apiKey}`;\n            const response = await fetch(buildApiUrl(options.baseUrl), {\n                method: 'POST',\n                headers,\n                body: JSON.stringify({\n                    model: options.model,\n                    stream: false,\n                    messages: [\n                        { role: 'system', content: options.systemPrompt },\n                        { role: 'user', content: userPrompt },\n                    ],\n                }),\n            });\n            if (!response.ok)\n                throw new Error(`: HTTP ${response.status}`);\n            const data = await response.json();\n            return String(data?.choices?.[0]?.message?.content ?? '').trim();\n        };\n        const requestSummaryText = async (userPrompt, useCurrentApi) => {\n            if (useCurrentApi && inTavern.value && settings.useTavernPreset) {\n                const text = await generate({ user_input: userPrompt, should_stream: false, should_silence: true });\n                if (String(text ?? '').trim())\n                    return String(text).trim();\n            }\n            return requestTextByManualApi(userPrompt);\n        };\n        const buildRecentTranscript = (floors = 2) => {\n            const playableFloors = Math.max(0, pageRanges.value.length - 1);\n            if (!playableFloors)\n                return '';\n            const end = playableFloors;\n            const start = Math.max(1, end - floors + 1);\n            return buildFloorTranscript(start, end);\n        };\n        const runSpecialMemoryNpcTurn = async (trigger) => {\n            if (!settings.specialMemoryEnabled)\n                return;\n            const npc = selectedSpecialMemoryNpc.value;\n            if (!npc) {\n                if (trigger === 'manual')\n                    pushSystemNotice('NPC');\n                return;\n            }\n            if (specialNpcRunning.value)\n                return;\n            specialNpcRunning.value = true;\n            let extraVars = '';\n            try {\n                extraVars = await fetchExtraVariablesByConfig({\n                    useVarApi: settings.specialMemoryUseVarApi,\n                    url: settings.specialMemoryVarApiUrl,\n                    key: settings.specialMemoryVarApiKey,\n                    payload: settings.specialMemoryVarApiPayload,\n                });\n            }\n            catch (error) {\n                pushSystemNotice(`NPCAPI${error?.message ?? String(error)}`);\n            }\n            try {\n                const prompt = [\n                    settings.specialMemoryPrompt,\n                    `[NPC] =${npc.name} | =${npc.role} | =${npc.relation} | =${npc.status} | =${npc.tags}`,\n                    '[]',\n                    playerBuildHint.value,\n                    memoryVaultHint.value ? `[]\\n${memoryVaultHint.value}` : '',\n                    '[]',\n                    buildRecentTranscript(2),\n                    extraVars ? `[API]\\n${extraVars}` : '',\n                    '[] NPC',\n                ]\n                    .filter(Boolean)\n                    .join('\\n\\n');\n                let actionText = '';\n                if (settings.specialMemoryUseCurrentApi && inTavern.value && settings.useTavernPreset) {\n                    const text = await generate({ user_input: prompt, should_stream: false, should_silence: true });\n                    actionText = String(text ?? '').trim();\n                }\n                else {\n                    actionText = await requestTextByApiConfig({\n                        baseUrl: settings.specialMemoryBaseUrl,\n                        apiKey: settings.specialMemoryApiKey,\n                        model: settings.specialMemoryModel,\n                        systemPrompt: 'NPC',\n                    }, prompt);\n                }\n                const action = actionText || '';\n                npcAutoActions.value.push({\n                    id: Date.now() + Math.floor(Math.random() * 10000),\n                    npcId: npc.id,\n                    name: npc.name,\n                    action,\n                    createdAt: Date.now(),\n                    source: trigger === 'manual' ? '' : '',\n                    extraVarNote: extraVars ? 'API' : 'API',\n                });\n                if (npcAutoActions.value.length > 60)\n                    npcAutoActions.value = npcAutoActions.value.slice(-60);\n                pushSystemNotice(` ${npc.name} `);\n            }\n            catch (error) {\n                if (trigger === 'manual')\n                    pushMessage('error', `NPC: ${error?.message ?? String(error)}`);\n            }\n            finally {\n                specialNpcRunning.value = false;\n            }\n        };\n        const maybeRunMegaSummary = async (force = false) => {\n            if (!settings.megaSummaryEnabled)\n                return;\n            const threshold = Math.max(1, Math.trunc(Number(settings.megaSummaryEvery) || 5));\n            const pending = memoryVault.value.length - megaSummaryLastCount.value;\n            if (!force && pending < threshold)\n                return;\n            if (pending <= 0 || !memoryVault.value.length)\n                return;\n            let extraVars = '';\n            try {\n                extraVars = await fetchExtraVariablesByConfig({\n                    useVarApi: settings.megaSummaryUseVarApi,\n                    url: settings.megaSummaryVarApiUrl,\n                    key: settings.megaSummaryVarApiKey,\n                    payload: settings.megaSummaryVarApiPayload,\n                });\n            }\n            catch (error) {\n                pushSystemNotice(`API${error?.message ?? String(error)}`);\n            }\n            const allSummaryText = memoryVault.value\n                .map(item => `${item.floorStart}-${item.floorEnd}\\n${item.summary}`)\n                .join('\\n\\n');\n            const megaPrompt = [\n                settings.megaSummaryPrompt,\n                `[]  ${threshold} : ${memoryVault.value.length}`,\n                '[]',\n                allSummaryText,\n                extraVars ? `[API]\\n${extraVars}` : '',\n                '[] ///',\n            ]\n                .filter(Boolean)\n                .join('\\n\\n');\n            const text = await requestSummaryText(megaPrompt, Boolean(settings.megaSummaryUseCurrentApi));\n            const first = memoryVault.value[0];\n            const last = memoryVault.value[memoryVault.value.length - 1];\n            megaMemoryVault.value.push({\n                id: Date.now() + Math.floor(Math.random() * 10000),\n                floorStart: first?.floorStart ?? 1,\n                floorEnd: last?.floorEnd ?? hiddenFloorUntil.value,\n                summary: text || '',\n                createdAt: Date.now(),\n                extraVarNote: extraVars ? 'API' : 'API',\n            });\n            megaSummaryLastCount.value = memoryVault.value.length;\n            pushSystemNotice('');\n        };\n        const runAutoSummaryForBlock = async (floorStart, floorEnd) => {\n            const transcript = buildFloorTranscript(floorStart, floorEnd).trim();\n            if (!transcript)\n                return;\n            let extraVars = '';\n            try {\n                extraVars = await fetchExtraVariablesByConfig({\n                    useVarApi: settings.summaryUseVarApi,\n                    url: settings.summaryVarApiUrl,\n                    key: settings.summaryVarApiKey,\n                    payload: settings.summaryVarApiPayload,\n                });\n            }\n            catch (error) {\n                pushSystemNotice(`API${error?.message ?? String(error)}`);\n            }\n            const summaryPrompt = [\n                settings.autoSummaryPrompt,\n                `[]  ${floorStart}-${floorEnd}`,\n                '[]',\n                playerBuildHint.value,\n                extraVars ? `[API]\\n${extraVars}` : '',\n                '[]',\n                transcript,\n                '[] ',\n            ]\n                .filter(Boolean)\n                .join('\\n\\n');\n            const summaryText = await requestSummaryText(summaryPrompt, Boolean(settings.summaryUseCurrentApi));\n            const summary = summaryText || '';\n            memoryVault.value.push({\n                id: Date.now() + Math.floor(Math.random() * 10000),\n                floorStart,\n                floorEnd,\n                summary,\n                createdAt: Date.now(),\n                extraVarNote: extraVars ? 'API' : 'API',\n            });\n            hiddenFloorUntil.value = floorEnd;\n            summaryLastFloor.value = floorEnd;\n            pushSystemNotice(` ${floorStart}-${floorEnd} `);\n            await maybeRunMegaSummary(false);\n        };\n        const maybeRunAutoSummary = async () => {\n            if (!settings.autoSummaryEnabled || summaryRunning.value)\n                return;\n            const floorsPerRun = Math.max(1, Math.trunc(Number(settings.summaryFloorsPerRun) || 5));\n            const playableFloors = Math.max(0, pageRanges.value.length - 1);\n            if (playableFloors < floorsPerRun)\n                return;\n            const nextTarget = Math.floor(playableFloors / floorsPerRun) * floorsPerRun;\n            if (nextTarget <= summaryLastFloor.value)\n                return;\n            summaryRunning.value = true;\n            startDbTask(` ${nextTarget}`);\n            try {\n                for (let start = summaryLastFloor.value + 1; start <= nextTarget; start += floorsPerRun) {\n                    const end = Math.min(start + floorsPerRun - 1, nextTarget);\n                    await runAutoSummaryForBlock(start, end);\n                }\n            }\n            catch (error) {\n                pushMessage('error', `: ${error?.message ?? String(error)}`);\n            }\n            finally {\n                summaryRunning.value = false;\n                finishDbTask();\n            }\n        };\n        const parseSseAndWrite = async (response, onDelta) => {\n            const reader = response.body?.getReader();\n            if (!reader)\n                return false;\n            const decoder = new TextDecoder();\n            let buffer = '';\n            while (true) {\n                const { value, done } = await reader.read();\n                if (done)\n                    break;\n                buffer += decoder.decode(value, { stream: true });\n                const lines = buffer.split(/\\r?\\n/);\n                buffer = lines.pop() ?? '';\n                for (const line of lines) {\n                    const trimmed = line.trim();\n                    if (!trimmed.startsWith('data:'))\n                        continue;\n                    const data = trimmed.slice(5).trim();\n                    if (data === '[DONE]')\n                        return true;\n                    try {\n                        const parsed = JSON.parse(data);\n                        const delta = parsed?.choices?.[0]?.delta?.content;\n                        if (typeof delta === 'string' && delta)\n                            onDelta(delta);\n                    }\n                    catch {\n                        // ignore malformed stream lines\n                    }\n                }\n            }\n            return true;\n        };\n        const requestWithTavernPreset = async () => {\n            const answer = { id: nextId.value++, role: 'assistant', content: '' };\n            messages.value.push(answer);\n            const lastUser = [...messages.value].reverse().find(item => item.role === 'user');\n            const text = await generate({ user_input: lastUser?.content ?? '', should_stream: true, should_silence: true });\n            answer.content = sanitizeAssistantContent(text || '[]');\n        };\n        const requestWithManualApi = async () => {\n            if (!settings.baseUrl || !settings.model) {\n                pushMessage('error', ' Base URL  Model');\n                return;\n            }\n            const answer = { id: nextId.value++, role: 'assistant', content: '' };\n            messages.value.push(answer);\n            const headers = { 'Content-Type': 'application/json' };\n            if (settings.apiKey)\n                headers.Authorization = `Bearer ${settings.apiKey}`;\n            const response = await fetch(buildApiUrl(settings.baseUrl), {\n                method: 'POST',\n                headers,\n                body: JSON.stringify({ model: settings.model, messages: buildPayloadMessages(), stream: true }),\n            });\n            if (!response.ok)\n                throw new Error(`HTTP ${response.status}: ${(await response.text()).slice(0, 400)}`);\n            const streamed = await parseSseAndWrite(response, text => (answer.content += text));\n            if (!streamed) {\n                const data = await response.json();\n                answer.content = data?.choices?.[0]?.message?.content ?? '[]';\n            }\n            answer.content = sanitizeAssistantContent(answer.content);\n            if (!answer.content.trim())\n                answer.content = '[]';\n        };\n        const requestAi = async () => {\n            pending.value = true;\n            try {\n                if (inTavern.value && settings.useTavernPreset)\n                    await requestWithTavernPreset();\n                else\n                    await requestWithManualApi();\n                await maybeRunAutoSummary();\n                void runSpecialMemoryNpcTurn('auto');\n            }\n            catch (error) {\n                pushMessage('error', `: ${error?.message ?? String(error)}`);\n            }\n            finally {\n                pending.value = false;\n            }\n        };\n        const sendUserInput = async () => {\n            const text = draft.value.trim();\n            if (!text || interactionLocked.value)\n                return;\n            pushMessage('user', text);\n            draft.value = '';\n            await requestAi();\n        };\n        const sendQuick = async (text) => {\n            if (interactionLocked.value)\n                return;\n            pushMessage('user', text);\n            await requestAi();\n        };\n        const formatTs = (ts) => new Date(ts).toLocaleString();\n        const clearMemoryVault = () => {\n            memoryVault.value = [];\n            megaMemoryVault.value = [];\n            summaryLastFloor.value = 0;\n            hiddenFloorUntil.value = 0;\n            megaSummaryLastCount.value = 0;\n            pushSystemNotice('');\n        };\n        const runManualSummary = async () => {\n            if (summaryRunning.value)\n                return;\n            const playableFloors = Math.max(0, pageRanges.value.length - 1);\n            if (playableFloors <= summaryLastFloor.value) {\n                pushSystemNotice('');\n                return;\n            }\n            const start = summaryLastFloor.value + 1;\n            const end = playableFloors;\n            summaryRunning.value = true;\n            startDbTask(` ${start}-${end}`);\n            try {\n                await runAutoSummaryForBlock(start, end);\n            }\n            catch (error) {\n                pushMessage('error', `: ${error?.message ?? String(error)}`);\n            }\n            finally {\n                summaryRunning.value = false;\n                finishDbTask();\n            }\n        };\n        const runManualMegaSummary = async () => {\n            if (summaryRunning.value)\n                return;\n            if (!settings.megaSummaryEnabled) {\n                pushSystemNotice('');\n                return;\n            }\n            summaryRunning.value = true;\n            startDbTask('');\n            try {\n                await maybeRunMegaSummary(true);\n            }\n            catch (error) {\n                pushMessage('error', `: ${error?.message ?? String(error)}`);\n            }\n            finally {\n                summaryRunning.value = false;\n                finishDbTask();\n            }\n        };\n        const addNpc = () => {\n            const name = npcEditor.name.trim();\n            if (!name) {\n                pushSystemNotice('NPC');\n                return;\n            }\n            const target = npcEditor.toLongterm ? longtermNpcs.value : onstageNpcs.value;\n            const exist = target.find(n => n.name === name);\n            const next = {\n                id: Date.now() + Math.floor(Math.random() * 10000),\n                name,\n                role: npcEditor.role.trim() || '',\n                relation: npcEditor.relation.trim() || '',\n                status: npcEditor.status.trim() || '',\n                tags: npcEditor.tags.trim() || '',\n            };\n            if (exist)\n                Object.assign(exist, next, { id: exist.id });\n            else\n                target.push(next);\n            npcEditor.name = '';\n            npcEditor.role = '';\n            npcEditor.relation = '';\n            npcEditor.status = '';\n            npcEditor.tags = '';\n            pushSystemNotice(`${npcEditor.toLongterm ? 'NPC' : ''}`);\n        };\n        const removeNpc = (id, type) => {\n            if (type === 'onstage')\n                onstageNpcs.value = onstageNpcs.value.filter(n => n.id !== id);\n            else\n                longtermNpcs.value = longtermNpcs.value.filter(n => n.id !== id);\n            if (Number(settings.specialMemoryNpcId) === id)\n                settings.specialMemoryNpcId = 0;\n        };\n        const addInventoryItem = () => {\n            if (!cheatMode.value) {\n                pushSystemNotice('');\n                return;\n            }\n            const name = inventoryEditor.name.trim();\n            if (!name) {\n                pushSystemNotice('');\n                return;\n            }\n            const count = Math.max(1, Math.trunc(Number(inventoryEditor.count) || 1));\n            const note = inventoryEditor.note.trim();\n            const exist = inventoryItems.value.find(item => item.name === name);\n            if (exist) {\n                exist.count = count;\n                exist.note = note || exist.note || '';\n            }\n            else {\n                inventoryItems.value.push({\n                    id: Date.now() + Math.floor(Math.random() * 10000),\n                    name,\n                    count,\n                    note: note || '',\n                });\n            }\n            inventoryEditor.name = '';\n            inventoryEditor.count = 1;\n            inventoryEditor.note = '';\n            pushSystemNotice('');\n        };\n        const removeInventoryItem = (id) => {\n            if (!cheatMode.value) {\n                pushSystemNotice('');\n                return;\n            }\n            inventoryItems.value = inventoryItems.value.filter(item => item.id !== id);\n        };\n        const startSession = () => {\n            started.value = true;\n            createDone.value = false;\n            createPage.value = 1;\n            createForm.background = '';\n            backgroundPresetKey.value = autoBackgroundPresetKey.value;\n            pushSystemNotice('');\n        };\n        const startNormalRoute = () => {\n            xenoRouteMode.value = false;\n            startSession();\n        };\n        const startXenoRoute = () => {\n            xenoRouteMode.value = true;\n            if (xenoRouteRole.value === '') {\n                createForm.profession = '';\n                createForm.gender = '';\n            }\n            else {\n                createForm.profession = '';\n            }\n            startSession();\n        };\n        const goCreatePageTwo = () => {\n            if (!createForm.name.trim()) {\n                pushSystemNotice('');\n                return;\n            }\n            const range = ageLimits[createForm.profession];\n            if (!Number.isFinite(createForm.age)) {\n                pushSystemNotice('');\n                return;\n            }\n            if (!cheatMode.value && (createForm.age < range.min || createForm.age > range.max)) {\n                pushSystemNotice(`${createForm.profession}${range.min}-${range.max}`);\n                return;\n            }\n            if (createForm.profession === '')\n                createForm.gender = '';\n            createPage.value = 2;\n        };\n        const goCreatePageThree = () => {\n            if (!cheatMode.value && humanPointsLeft.value !== 0) {\n                pushSystemNotice(` ${humanPointsLeft.value} `);\n                return;\n            }\n            createPage.value = 3;\n        };\n        const applyBackgroundPreset = () => {\n            const text = backgroundTemplateMap[backgroundPresetKey.value] ?? '';\n            if (!text) {\n                pushSystemNotice('');\n                return;\n            }\n            createForm.background = text.slice(0, 1000);\n            pushSystemNotice('');\n        };\n        const incHumanAttr = (key) => {\n            if (humanPointsLeft.value <= 0)\n                return;\n            if (createHumanAttr[key] >= 5)\n                return;\n            createHumanAttr[key] += 1;\n        };\n        const decHumanAttr = (key) => {\n            if (createHumanAttr[key] <= 1)\n                return;\n            createHumanAttr[key] -= 1;\n        };\n        const finishCreate = () => {\n            if (createPage.value !== 3) {\n                pushSystemNotice('3');\n                return;\n            }\n            if (!cheatMode.value && humanPointsLeft.value !== 0) {\n                pushSystemNotice(` ${humanPointsLeft.value} `);\n                return;\n            }\n            if ((createForm.background || '').length > 1000) {\n                pushSystemNotice('1000');\n                return;\n            }\n            createDone.value = true;\n            messages.value = [\n                {\n                    id: 1,\n                    role: 'assistant',\n                    content: xenoRouteMode.value ? xenoOpeningStory : normalOpeningStory,\n                },\n            ];\n            nextId.value = 2;\n            currentPage.value = 0;\n            memoryVault.value = [];\n            megaMemoryVault.value = [];\n            onstageNpcs.value = [];\n            longtermNpcs.value = [];\n            inventoryItems.value = [];\n            resetPlayerResource();\n            summaryLastFloor.value = 0;\n            hiddenFloorUntil.value = 0;\n            megaSummaryLastCount.value = 0;\n            pushSystemNotice(`${createForm.name} / ${createForm.profession} / ${createForm.age} / ${createForm.gender} / ${xenoRouteMode.value ? '' : ''} / ${plotMode.value ? '' : ''} / ${createForm.background.length}`);\n        };\n        const fullscreenTarget = () => (rootRef.value ?? document.documentElement);\n        const getFullscreenElement = () => document.fullscreenElement ||\n            document.webkitFullscreenElement ||\n            document.mozFullScreenElement ||\n            document.msFullscreenElement;\n        const enterFullscreen = async () => {\n            const target = fullscreenTarget();\n            const fn = target.requestFullscreen ||\n                target.webkitRequestFullscreen ||\n                target.mozRequestFullScreen ||\n                target.msRequestFullscreen;\n            if (typeof fn === 'function')\n                await fn.call(target);\n        };\n        const exitFullscreen = async () => {\n            const doc = document;\n            const fn = doc.exitFullscreen || doc.webkitExitFullscreen || doc.mozCancelFullScreen || doc.msExitFullscreen;\n            if (typeof fn === 'function')\n                await fn.call(doc);\n        };\n        const syncFullscreenState = () => {\n            isFullscreen.value = Boolean(getFullscreenElement());\n        };\n        const toggleFullscreen = async () => {\n            try {\n                if (getFullscreenElement())\n                    await exitFullscreen();\n                else\n                    await enterFullscreen();\n                syncFullscreenState();\n            }\n            catch (error) {\n                pushSystemNotice(`: ${error?.message ?? String(error)}`);\n            }\n        };\n        onMounted(() => {\n            loadSettings();\n            loadRuntimeState();\n            if (inTavern.value)\n                pullFromTavern();\n            if (props.mode === 'embedded')\n                showSettings.value = false;\n            ['fullscreenchange', 'webkitfullscreenchange', 'mozfullscreenchange', 'MSFullscreenChange'].forEach(eventName => {\n                document.addEventListener(eventName, syncFullscreenState);\n            });\n        });\n        onUnmounted(() => {\n            if (dbTickTimer) {\n                clearInterval(dbTickTimer);\n                dbTickTimer = null;\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"main\", {\n                ref_key: \"rootRef\",\n                ref: rootRef,\n                class: \"shell\",\n                onClick: _cache[68] || (_cache[68] = _withModifiers(() => { }, [\"stop\"]))\n            }, [\n                (!_unref(started))\n                    ? (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n                        _cache[74] || (_cache[74] = _createElementVNode(\"div\", { class: \"start-screen__veil\" }, null, -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _cache[69] || (_cache[69] = _createElementVNode(\"p\", { class: \"start-card__kicker\" }, \"LIBRARY NODE / LAYER SESSION\", -1 /* CACHED */)),\n                            _cache[70] || (_cache[70] = _createElementVNode(\"h2\", null, \"\", -1 /* CACHED */)),\n                            _cache[71] || (_cache[71] = _createElementVNode(\"p\", { class: \"start-card__author\" }, \"\", -1 /* CACHED */)),\n                            _cache[72] || (_cache[72] = _createElementVNode(\"p\", { class: \"start-card__desc\" }, \"AI\", -1 /* CACHED */)),\n                            _cache[73] || (_cache[73] = _createElementVNode(\"p\", { class: \"start-card__quote\" }, \"[]\", -1 /* CACHED */)),\n                            _createElementVNode(\"p\", _hoisted_3, \"\" + _toDisplayString(_unref(xenoRouteMode) ? `${_unref(xenoRouteRole)}` : ''), 1 /* TEXT */),\n                            _createElementVNode(\"p\", _hoisted_4, \"\" + _toDisplayString(_unref(cheatMode) ? '' : ''), 1 /* TEXT */),\n                            _createElementVNode(\"p\", _hoisted_5, \"\" + _toDisplayString(_unref(plotMode) ? '' : ''), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                _createElementVNode(\"button\", {\n                                    type: \"button\",\n                                    onClick: startNormalRoute\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    type: \"button\",\n                                    class: \"xeno\",\n                                    onClick: startXenoRoute\n                                }, _toDisplayString(_unref(xenoRouteMode) ? '' : ''), 1 /* TEXT */),\n                                _createElementVNode(\"button\", {\n                                    type: \"button\",\n                                    class: \"ghost\",\n                                    onClick: _cache[0] || (_cache[0] = ($event) => (plotMode.value = !_unref(plotMode)))\n                                }, _toDisplayString(_unref(plotMode) ? '' : ''), 1 /* TEXT */),\n                                _createElementVNode(\"button\", {\n                                    type: \"button\",\n                                    class: \"ghost\",\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (cheatMode.value = !_unref(cheatMode)))\n                                }, _toDisplayString(_unref(cheatMode) ? '' : ''), 1 /* TEXT */),\n                                _createElementVNode(\"button\", {\n                                    type: \"button\",\n                                    class: \"ghost\",\n                                    onClick: pullFromTavern\n                                }, \"\")\n                            ])\n                        ])\n                    ]))\n                    : (!_unref(createDone) && _unref(createPage) === 1)\n                        ? (_openBlock(), _createElementBlock(\"section\", _hoisted_7, [\n                            _cache[85] || (_cache[85] = _createElementVNode(\"h2\", null, \" - 1\", -1 /* CACHED */)),\n                            _createElementVNode(\"label\", null, [\n                                _cache[75] || (_cache[75] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                _withDirectives(_createElementVNode(\"input\", {\n                                    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_unref(createForm).name) = $event)),\n                                    placeholder: \"\"\n                                }, null, 512 /* NEED_PATCH */), [\n                                    [\n                                        _vModelText,\n                                        _unref(createForm).name,\n                                        void 0,\n                                        { trim: true }\n                                    ]\n                                ])\n                            ]),\n                            _createElementVNode(\"label\", null, [\n                                _cache[76] || (_cache[76] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                _withDirectives(_createElementVNode(\"select\", {\n                                    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((_unref(createForm).profession) = $event)),\n                                    disabled: _unref(xenoRouteMode)\n                                }, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(professionOptions, (item) => {\n                                        return _createElementVNode(\"option\", {\n                                            key: item,\n                                            value: item\n                                        }, _toDisplayString(item), 9 /* TEXT, PROPS */, _hoisted_9);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ], 8 /* PROPS */, _hoisted_8), [\n                                    [_vModelSelect, _unref(createForm).profession]\n                                ])\n                            ]),\n                            (_unref(xenoRouteMode))\n                                ? (_openBlock(), _createElementBlock(\"section\", _hoisted_10, [\n                                    _cache[79] || (_cache[79] = _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"label\", null, [\n                                        _cache[78] || (_cache[78] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"select\", {\n                                            \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event) => (_isRef(xenoRouteRole) ? (xenoRouteRole).value = $event : null))\n                                        }, [...(_cache[77] || (_cache[77] = [\n                                                _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"\" }, \"\", -1 /* CACHED */)\n                                            ]))], 512 /* NEED_PATCH */), [\n                                            [_vModelSelect, _unref(xenoRouteRole)]\n                                        ])\n                                    ]),\n                                    _cache[80] || (_cache[80] = _createElementVNode(\"p\", { class: \"hint\" }, \"\", -1 /* CACHED */))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createElementVNode(\"label\", _hoisted_11, [\n                                _cache[81] || (_cache[81] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"textarea\", {\n                                    value: _unref(professionDescription),\n                                    rows: \"9\",\n                                    readonly: \"\"\n                                }, null, 8 /* PROPS */, _hoisted_12)\n                            ]),\n                            _createElementVNode(\"label\", null, [\n                                _createElementVNode(\"span\", null, \"\" + _toDisplayString(_unref(currentAgeRange).min) + \"-\" + _toDisplayString(_unref(currentAgeRange).max) + \"\", 1 /* TEXT */),\n                                _withDirectives(_createElementVNode(\"input\", {\n                                    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((_unref(createForm).age) = $event)),\n                                    type: \"number\",\n                                    min: _unref(currentAgeRange).min,\n                                    max: _unref(currentAgeRange).max,\n                                    placeholder: \"\"\n                                }, null, 8 /* PROPS */, _hoisted_13), [\n                                    [\n                                        _vModelText,\n                                        _unref(createForm).age,\n                                        void 0,\n                                        { number: true }\n                                    ]\n                                ])\n                            ]),\n                            _createElementVNode(\"label\", null, [\n                                _cache[82] || (_cache[82] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                _withDirectives(_createElementVNode(\"select\", {\n                                    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event) => ((_unref(createForm).gender) = $event)),\n                                    disabled: _unref(createForm).profession === ''\n                                }, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(genderOptions, (item) => {\n                                        return _createElementVNode(\"option\", {\n                                            key: item,\n                                            value: item\n                                        }, _toDisplayString(item), 9 /* TEXT, PROPS */, _hoisted_15);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ], 8 /* PROPS */, _hoisted_14), [\n                                    [_vModelSelect, _unref(createForm).gender]\n                                ])\n                            ]),\n                            (_unref(createForm).profession === '')\n                                ? (_openBlock(), _createElementBlock(\"label\", _hoisted_16, [\n                                    _cache[83] || (_cache[83] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                    _withDirectives(_createElementVNode(\"select\", {\n                                        \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event) => ((_unref(createForm).warmaidType) = $event))\n                                    }, [\n                                        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(warmaidTypeOptions, (item) => {\n                                            return _createElementVNode(\"option\", {\n                                                key: item,\n                                                value: item\n                                            }, _toDisplayString(item), 9 /* TEXT, PROPS */, _hoisted_17);\n                                        }), 64 /* STABLE_FRAGMENT */))\n                                    ], 512 /* NEED_PATCH */), [\n                                        [_vModelSelect, _unref(createForm).warmaidType]\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (_unref(createForm).profession === '')\n                                ? (_openBlock(), _createElementBlock(\"label\", _hoisted_18, [\n                                    _cache[84] || (_cache[84] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"textarea\", {\n                                        value: _unref(warmaidTypeDescription),\n                                        rows: \"10\",\n                                        readonly: \"\"\n                                    }, null, 8 /* PROPS */, _hoisted_19)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createElementVNode(\"div\", _hoisted_20, [\n                                _createElementVNode(\"button\", {\n                                    type: \"button\",\n                                    class: \"ghost\",\n                                    onClick: _cache[8] || (_cache[8] = ($event) => (started.value = false))\n                                }, \"\"),\n                                _createElementVNode(\"button\", {\n                                    type: \"button\",\n                                    onClick: goCreatePageTwo\n                                }, \"\")\n                            ])\n                        ]))\n                        : (!_unref(createDone) && _unref(createPage) === 2)\n                            ? (_openBlock(), _createElementBlock(\"section\", _hoisted_21, [\n                                _cache[86] || (_cache[86] = _createElementVNode(\"h2\", null, \" - 2\", -1 /* CACHED */)),\n                                _cache[87] || (_cache[87] = _createElementVNode(\"p\", { class: \"hint\" }, \" 1 5  5\", -1 /* CACHED */)),\n                                _createElementVNode(\"p\", _hoisted_22, \"\" + _toDisplayString(_unref(humanPointsLeft)), 1 /* TEXT */),\n                                _createElementVNode(\"section\", _hoisted_23, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(humanAttrItems, (item) => {\n                                        return _createElementVNode(\"article\", {\n                                            key: item.key,\n                                            class: \"attr-item\"\n                                        }, [\n                                            _createElementVNode(\"header\", null, [\n                                                _createElementVNode(\"strong\", null, _toDisplayString(item.key), 1 /* TEXT */),\n                                                _createElementVNode(\"span\", null, _toDisplayString(item.desc), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_24, [\n                                                _createElementVNode(\"button\", {\n                                                    type: \"button\",\n                                                    class: \"ghost\",\n                                                    disabled: _unref(createHumanAttr)[item.key] <= 1,\n                                                    onClick: ($event) => (decHumanAttr(item.key))\n                                                }, \"-\", 8 /* PROPS */, _hoisted_25),\n                                                _createElementVNode(\"b\", null, _toDisplayString(_unref(createHumanAttr)[item.key]), 1 /* TEXT */),\n                                                _createElementVNode(\"button\", {\n                                                    type: \"button\",\n                                                    disabled: _unref(humanPointsLeft) <= 0 || _unref(createHumanAttr)[item.key] >= 5,\n                                                    onClick: ($event) => (incHumanAttr(item.key))\n                                                }, \"+\", 8 /* PROPS */, _hoisted_26)\n                                            ])\n                                        ]);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_27, [\n                                    _createElementVNode(\"button\", {\n                                        type: \"button\",\n                                        class: \"ghost\",\n                                        onClick: _cache[9] || (_cache[9] = ($event) => (createPage.value = 1))\n                                    }, \"\"),\n                                    _createElementVNode(\"button\", {\n                                        type: \"button\",\n                                        onClick: goCreatePageThree\n                                    }, \"\")\n                                ])\n                            ]))\n                            : (!_unref(createDone) && _unref(createPage) === 3)\n                                ? (_openBlock(), _createElementBlock(\"section\", _hoisted_28, [\n                                    _cache[90] || (_cache[90] = _createElementVNode(\"h2\", null, \" - 3\", -1 /* CACHED */)),\n                                    _cache[91] || (_cache[91] = _createElementVNode(\"p\", { class: \"hint\" }, \"1000\", -1 /* CACHED */)),\n                                    _createElementVNode(\"label\", null, [\n                                        _cache[88] || (_cache[88] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"select\", {\n                                            \"onUpdate:modelValue\": _cache[10] || (_cache[10] = ($event) => (_isRef(backgroundPresetKey) ? (backgroundPresetKey).value = $event : null))\n                                        }, [\n                                            (_openBlock(), _createElementBlock(_Fragment, null, _renderList(backgroundPresetOptions, (item) => {\n                                                return _createElementVNode(\"option\", {\n                                                    key: item.key,\n                                                    value: item.key\n                                                }, _toDisplayString(item.label), 9 /* TEXT, PROPS */, _hoisted_29);\n                                            }), 64 /* STABLE_FRAGMENT */))\n                                        ], 512 /* NEED_PATCH */), [\n                                            [_vModelSelect, _unref(backgroundPresetKey)]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_30, [\n                                        _createElementVNode(\"button\", {\n                                            type: \"button\",\n                                            class: \"ghost\",\n                                            onClick: applyBackgroundPreset\n                                        }, \"\"),\n                                        _createElementVNode(\"span\", _hoisted_31, \"\" + _toDisplayString(_unref(currentBackgroundPresetLabel)), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"label\", _hoisted_32, [\n                                        _cache[89] || (_cache[89] = _createElementVNode(\"span\", null, \"0-1000\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                            \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event) => ((_unref(createForm).background) = $event)),\n                                            rows: \"12\",\n                                            maxlength: \"1000\",\n                                            placeholder: \"\"\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, _unref(createForm).background]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_33, \" \" + _toDisplayString(_unref(createForm).background.length) + \"/1000\", 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_34, [\n                                        _createElementVNode(\"button\", {\n                                            type: \"button\",\n                                            class: \"ghost\",\n                                            onClick: _cache[12] || (_cache[12] = ($event) => (createPage.value = 2))\n                                        }, \"\"),\n                                        _createElementVNode(\"button\", {\n                                            type: \"button\",\n                                            onClick: finishCreate\n                                        }, \"\")\n                                    ])\n                                ]))\n                                : (_openBlock(), _createElementBlock(_Fragment, { key: 4 }, [\n                                    _createElementVNode(\"header\", _hoisted_35, [\n                                        _cache[92] || (_cache[92] = _createElementVNode(\"div\", { class: \"title\" }, [\n                                            _createElementVNode(\"h1\", null, \"\"),\n                                            _createElementVNode(\"p\", null, \"Ruina Style / Auto Paging / Tavern API Bridge\")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_36, [\n                                            _createElementVNode(\"button\", {\n                                                type: \"button\",\n                                                class: \"ghost db-btn\",\n                                                onClick: _cache[13] || (_cache[13] = ($event) => (showSummaryCenter.value = !_unref(showSummaryCenter)))\n                                            }, _toDisplayString(_unref(showSummaryCenter) ? '' : ''), 1 /* TEXT */),\n                                            _createElementVNode(\"button\", {\n                                                type: \"button\",\n                                                class: \"ghost\",\n                                                onClick: toggleFullscreen\n                                            }, _toDisplayString(_unref(isFullscreen) ? '' : ''), 1 /* TEXT */),\n                                            _createElementVNode(\"button\", {\n                                                type: \"button\",\n                                                class: \"ghost\",\n                                                onClick: _cache[14] || (_cache[14] = ($event) => (showSettings.value = !_unref(showSettings)))\n                                            }, _toDisplayString(_unref(showSettings) ? '' : ''), 1 /* TEXT */)\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"section\", _hoisted_37, [\n                                        _createElementVNode(\"aside\", _hoisted_38, [\n                                            _cache[103] || (_cache[103] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"dl\", null, [\n                                                _createElementVNode(\"div\", null, [\n                                                    _cache[93] || (_cache[93] = _createElementVNode(\"dt\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"dd\", null, _toDisplayString(_unref(createForm).name || ''), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", null, [\n                                                    _cache[94] || (_cache[94] = _createElementVNode(\"dt\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"dd\", null, _toDisplayString(_unref(createForm).gender), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", null, [\n                                                    _cache[95] || (_cache[95] = _createElementVNode(\"dt\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"dd\", null, _toDisplayString(_unref(createForm).profession), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", null, [\n                                                    _cache[96] || (_cache[96] = _createElementVNode(\"dt\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"dd\", null, _toDisplayString(_unref(xenoRouteMode) ? `/${_unref(xenoRouteRole)}` : ''), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", null, [\n                                                    _cache[97] || (_cache[97] = _createElementVNode(\"dt\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"dd\", null, _toDisplayString(_unref(cheatMode) ? '' : ''), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", null, [\n                                                    _cache[98] || (_cache[98] = _createElementVNode(\"dt\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"dd\", null, _toDisplayString(_unref(plotMode) ? '' : ''), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_39, [\n                                                    _cache[99] || (_cache[99] = _createElementVNode(\"dt\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"dd\", null, [\n                                                        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(humanAttrItems, (item) => {\n                                                            return _createElementVNode(\"span\", {\n                                                                key: item.key,\n                                                                class: \"attr-chip\"\n                                                            }, _toDisplayString(item.key) + \" \" + _toDisplayString(_unref(createHumanAttr)[item.key]), 1 /* TEXT */);\n                                                        }), 64 /* STABLE_FRAGMENT */))\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_40, [\n                                                    _cache[100] || (_cache[100] = _createElementVNode(\"dt\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"dd\", null, [\n                                                        _createElementVNode(\"span\", _hoisted_41, \" \" + _toDisplayString(_unref(playerResource).hp) + \"/\" + _toDisplayString(_unref(playerResource).hpMax), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_42, \" \" + _toDisplayString(_unref(playerResource).mp) + \"/\" + _toDisplayString(_unref(playerResource).mpMax), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_43, \" \" + _toDisplayString(_unref(playerResource).ap), 1 /* TEXT */)\n                                                    ])\n                                                ]),\n                                                _createElementVNode(\"div\", null, [\n                                                    _cache[101] || (_cache[101] = _createElementVNode(\"dt\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"dd\", null, _toDisplayString(_unref(backgroundSummary)), 1 /* TEXT */)\n                                                ])\n                                            ]),\n                                            _createElementVNode(\"section\", _hoisted_44, [\n                                                _createElementVNode(\"div\", _hoisted_45, [\n                                                    _cache[102] || (_cache[102] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"button\", {\n                                                        type: \"button\",\n                                                        class: \"ghost small\",\n                                                        onClick: _cache[15] || (_cache[15] = ($event) => (showInventoryPanel.value = !_unref(showInventoryPanel)))\n                                                    }, _toDisplayString(_unref(showInventoryPanel) ? '' : ''), 1 /* TEXT */)\n                                                ]),\n                                                (_unref(showInventoryPanel))\n                                                    ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                                        (_unref(cheatMode))\n                                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_46, [\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    \"onUpdate:modelValue\": _cache[16] || (_cache[16] = ($event) => ((_unref(inventoryEditor).name) = $event)),\n                                                                    placeholder: \"\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(inventoryEditor).name,\n                                                                        void 0,\n                                                                        { trim: true }\n                                                                    ]\n                                                                ]),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    \"onUpdate:modelValue\": _cache[17] || (_cache[17] = ($event) => ((_unref(inventoryEditor).count) = $event)),\n                                                                    type: \"number\",\n                                                                    min: \"1\",\n                                                                    placeholder: \"\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(inventoryEditor).count,\n                                                                        void 0,\n                                                                        { number: true }\n                                                                    ]\n                                                                ]),\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    \"onUpdate:modelValue\": _cache[18] || (_cache[18] = ($event) => ((_unref(inventoryEditor).note) = $event)),\n                                                                    placeholder: \"\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [\n                                                                        _vModelText,\n                                                                        _unref(inventoryEditor).note,\n                                                                        void 0,\n                                                                        { trim: true }\n                                                                    ]\n                                                                ]),\n                                                                _createElementVNode(\"button\", {\n                                                                    type: \"button\",\n                                                                    class: \"ghost small\",\n                                                                    onClick: addInventoryItem\n                                                                }, \"\")\n                                                            ]))\n                                                            : (_openBlock(), _createElementBlock(\"p\", _hoisted_47, \"\")),\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(inventoryItems), (item) => {\n                                                            return (_openBlock(), _createElementBlock(\"article\", {\n                                                                key: item.id,\n                                                                class: \"inventory-item\"\n                                                            }, [\n                                                                _createElementVNode(\"header\", null, [\n                                                                    _createElementVNode(\"strong\", null, _toDisplayString(item.name) + \" \" + _toDisplayString(item.count), 1 /* TEXT */),\n                                                                    (_unref(cheatMode))\n                                                                        ? (_openBlock(), _createElementBlock(\"button\", {\n                                                                            key: 0,\n                                                                            type: \"button\",\n                                                                            class: \"ghost small\",\n                                                                            onClick: ($event) => (removeInventoryItem(item.id))\n                                                                        }, \"\", 8 /* PROPS */, _hoisted_48))\n                                                                        : _createCommentVNode(\"v-if\", true)\n                                                                ]),\n                                                                _createElementVNode(\"p\", null, \"\" + _toDisplayString(item.note), 1 /* TEXT */)\n                                                            ]));\n                                                        }), 128 /* KEYED_FRAGMENT */)),\n                                                        (!_unref(inventoryItems).length)\n                                                            ? (_openBlock(), _createElementBlock(\"p\", _hoisted_49, \"\"))\n                                                            : _createCommentVNode(\"v-if\", true)\n                                                    ], 64 /* STABLE_FRAGMENT */))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_50, [\n                                            _createElementVNode(\"section\", _hoisted_51, [\n                                                _createElementVNode(\"div\", _hoisted_52, [\n                                                    _createElementVNode(\"button\", {\n                                                        type: \"button\",\n                                                        class: \"ghost\",\n                                                        disabled: _unref(currentPage) <= 0,\n                                                        onClick: _cache[19] || (_cache[19] = ($event) => (currentPage.value--))\n                                                    }, \"\", 8 /* PROPS */, _hoisted_53),\n                                                    _createElementVNode(\"span\", _hoisted_54, \" \" + _toDisplayString(_unref(currentPage) + 1) + \" / \" + _toDisplayString(_unref(pageRanges).length) + \" \", 1 /* TEXT */),\n                                                    _createElementVNode(\"button\", {\n                                                        type: \"button\",\n                                                        class: \"ghost\",\n                                                        disabled: _unref(currentPage) >= _unref(pageRanges).length - 1,\n                                                        onClick: _cache[20] || (_cache[20] = ($event) => (currentPage.value++))\n                                                    }, \"  \", 8 /* PROPS */, _hoisted_55)\n                                                ]),\n                                                _createElementVNode(\"label\", _hoisted_56, [\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        \"onUpdate:modelValue\": _cache[21] || (_cache[21] = ($event) => ((_unref(settings).autoFlipPage) = $event)),\n                                                        type: \"checkbox\"\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [_vModelCheckbox, _unref(settings).autoFlipPage]\n                                                    ]),\n                                                    _cache[104] || (_cache[104] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */))\n                                                ])\n                                            ]),\n                                            (_unref(showSettings))\n                                                ? (_openBlock(), _createElementBlock(\"section\", _hoisted_57, [\n                                                    _createElementVNode(\"div\", _hoisted_58, [\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"button\",\n                                                            onClick: pullFromTavern\n                                                        }, \"/API\"),\n                                                        _createElementVNode(\"span\", _hoisted_59, _toDisplayString(_unref(tavernSummary)), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_60, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[22] || (_cache[22] = ($event) => ((_unref(settings).useTavernPreset) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).useTavernPreset]\n                                                        ]),\n                                                        _cache[105] || (_cache[105] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[106] || (_cache[106] = _createElementVNode(\"span\", null, \"Base URL\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[23] || (_cache[23] = ($event) => ((_unref(settings).baseUrl) = $event)),\n                                                            placeholder: \"https://api.openai.com/v1\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).baseUrl,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[107] || (_cache[107] = _createElementVNode(\"span\", null, \"API Key\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[24] || (_cache[24] = ($event) => ((_unref(settings).apiKey) = $event)),\n                                                            type: \"password\",\n                                                            placeholder: \"sk-...\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).apiKey,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[108] || (_cache[108] = _createElementVNode(\"span\", null, \"Model\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[25] || (_cache[25] = ($event) => ((_unref(settings).model) = $event)),\n                                                            list: \"th-model-options\",\n                                                            placeholder: \"gpt-4.1-mini\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).model,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ]),\n                                                        _createElementVNode(\"datalist\", _hoisted_61, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(modelOptions), (item) => {\n                                                                return (_openBlock(), _createElementBlock(\"option\", {\n                                                                    key: item,\n                                                                    value: item\n                                                                }, _toDisplayString(item), 9 /* TEXT, PROPS */, _hoisted_62));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_63, [\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"button\",\n                                                            class: \"ghost small\",\n                                                            disabled: _unref(modelFetchRunning),\n                                                            onClick: fetchModelOptions\n                                                        }, _toDisplayString(_unref(modelFetchRunning) ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_64),\n                                                        _createElementVNode(\"span\", _hoisted_65, _toDisplayString(_unref(modelOptions).length ? ` ${_unref(modelOptions).length} ` : 'URL'), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[109] || (_cache[109] = _createElementVNode(\"span\", null, \"System Prompt\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                                            \"onUpdate:modelValue\": _cache[26] || (_cache[26] = ($event) => ((_unref(settings).systemPrompt) = $event)),\n                                                            rows: \"3\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).systemPrompt]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_66, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[27] || (_cache[27] = ($event) => ((_unref(settings).autoSummaryEnabled) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).autoSummaryEnabled]\n                                                        ]),\n                                                        _cache[110] || (_cache[110] = _createElementVNode(\"span\", null, \" 5 \", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[111] || (_cache[111] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[28] || (_cache[28] = ($event) => ((_unref(settings).summaryFloorsPerRun) = $event)),\n                                                            type: \"number\",\n                                                            min: \"1\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).summaryFloorsPerRun,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_67, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[29] || (_cache[29] = ($event) => ((_unref(settings).summaryUseCurrentApi) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).summaryUseCurrentApi]\n                                                        ]),\n                                                        _cache[112] || (_cache[112] = _createElementVNode(\"span\", null, \"API\", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_68, [\n                                                        _cache[113] || (_cache[113] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                                            \"onUpdate:modelValue\": _cache[30] || (_cache[30] = ($event) => ((_unref(settings).autoSummaryPrompt) = $event)),\n                                                            rows: \"4\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).autoSummaryPrompt]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_69, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[31] || (_cache[31] = ($event) => ((_unref(settings).summaryUseVarApi) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).summaryUseVarApi]\n                                                        ]),\n                                                        _cache[114] || (_cache[114] = _createElementVNode(\"span\", null, \"API\", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[115] || (_cache[115] = _createElementVNode(\"span\", null, \"API URL\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[32] || (_cache[32] = ($event) => ((_unref(settings).summaryVarApiUrl) = $event)),\n                                                            placeholder: \"https://your-api/vars\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).summaryVarApiUrl,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[116] || (_cache[116] = _createElementVNode(\"span\", null, \"API Key\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[33] || (_cache[33] = ($event) => ((_unref(settings).summaryVarApiKey) = $event)),\n                                                            type: \"password\",\n                                                            placeholder: \"Bearer Token\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).summaryVarApiKey,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_70, [\n                                                        _cache[117] || (_cache[117] = _createElementVNode(\"span\", null, \"APIJSON\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                                            \"onUpdate:modelValue\": _cache[34] || (_cache[34] = ($event) => ((_unref(settings).summaryVarApiPayload) = $event)),\n                                                            rows: \"3\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).summaryVarApiPayload]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_71, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[35] || (_cache[35] = ($event) => ((_unref(settings).megaSummaryEnabled) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).megaSummaryEnabled]\n                                                        ]),\n                                                        _cache[118] || (_cache[118] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[119] || (_cache[119] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[36] || (_cache[36] = ($event) => ((_unref(settings).megaSummaryEvery) = $event)),\n                                                            type: \"number\",\n                                                            min: \"1\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).megaSummaryEvery,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_72, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[37] || (_cache[37] = ($event) => ((_unref(settings).megaSummaryUseCurrentApi) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).megaSummaryUseCurrentApi]\n                                                        ]),\n                                                        _cache[120] || (_cache[120] = _createElementVNode(\"span\", null, \"API\", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_73, [\n                                                        _cache[121] || (_cache[121] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                                            \"onUpdate:modelValue\": _cache[38] || (_cache[38] = ($event) => ((_unref(settings).megaSummaryPrompt) = $event)),\n                                                            rows: \"4\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).megaSummaryPrompt]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_74, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[39] || (_cache[39] = ($event) => ((_unref(settings).megaSummaryUseVarApi) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).megaSummaryUseVarApi]\n                                                        ]),\n                                                        _cache[122] || (_cache[122] = _createElementVNode(\"span\", null, \"API\", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[123] || (_cache[123] = _createElementVNode(\"span\", null, \"API URL\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[40] || (_cache[40] = ($event) => ((_unref(settings).megaSummaryVarApiUrl) = $event)),\n                                                            placeholder: \"https://your-api/mega-vars\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).megaSummaryVarApiUrl,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[124] || (_cache[124] = _createElementVNode(\"span\", null, \"API Key\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[41] || (_cache[41] = ($event) => ((_unref(settings).megaSummaryVarApiKey) = $event)),\n                                                            type: \"password\",\n                                                            placeholder: \"Bearer Token\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).megaSummaryVarApiKey,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_75, [\n                                                        _cache[125] || (_cache[125] = _createElementVNode(\"span\", null, \"APIJSON\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                                            \"onUpdate:modelValue\": _cache[42] || (_cache[42] = ($event) => ((_unref(settings).megaSummaryVarApiPayload) = $event)),\n                                                            rows: \"3\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).megaSummaryVarApiPayload]\n                                                        ])\n                                                    ]),\n                                                    _cache[138] || (_cache[138] = _createElementVNode(\"hr\", null, null, -1 /* CACHED */)),\n                                                    _createElementVNode(\"label\", _hoisted_76, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[43] || (_cache[43] = ($event) => ((_unref(settings).specialMemoryEnabled) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).specialMemoryEnabled]\n                                                        ]),\n                                                        _cache[126] || (_cache[126] = _createElementVNode(\"span\", null, \"NPC\", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[128] || (_cache[128] = _createElementVNode(\"span\", null, \"NPC\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"select\", {\n                                                            \"onUpdate:modelValue\": _cache[44] || (_cache[44] = ($event) => ((_unref(settings).specialMemoryNpcId) = $event))\n                                                        }, [\n                                                            _cache[127] || (_cache[127] = _createElementVNode(\"option\", { value: 0 }, \"\", -1 /* CACHED */)),\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(allNpcs), (npc) => {\n                                                                return (_openBlock(), _createElementBlock(\"option\", {\n                                                                    key: npc.id,\n                                                                    value: npc.id\n                                                                }, _toDisplayString(npc.name) + \"\" + _toDisplayString(npc.role) + \"\", 9 /* TEXT, PROPS */, _hoisted_77));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ], 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelSelect,\n                                                                _unref(settings).specialMemoryNpcId,\n                                                                void 0,\n                                                                { number: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_78, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[45] || (_cache[45] = ($event) => ((_unref(settings).specialMemoryUseCurrentApi) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).specialMemoryUseCurrentApi]\n                                                        ]),\n                                                        _cache[129] || (_cache[129] = _createElementVNode(\"span\", null, \"NPCAPI\", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[130] || (_cache[130] = _createElementVNode(\"span\", null, \"NPC Base URL\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[46] || (_cache[46] = ($event) => ((_unref(settings).specialMemoryBaseUrl) = $event)),\n                                                            placeholder: \"https://api.openai.com/v1\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).specialMemoryBaseUrl,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[131] || (_cache[131] = _createElementVNode(\"span\", null, \"NPC API Key\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[47] || (_cache[47] = ($event) => ((_unref(settings).specialMemoryApiKey) = $event)),\n                                                            type: \"password\",\n                                                            placeholder: \"sk-...\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).specialMemoryApiKey,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[132] || (_cache[132] = _createElementVNode(\"span\", null, \"NPC Model\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[48] || (_cache[48] = ($event) => ((_unref(settings).specialMemoryModel) = $event)),\n                                                            list: \"th-special-model-options\",\n                                                            placeholder: \"gpt-4.1-mini\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).specialMemoryModel,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ]),\n                                                        _createElementVNode(\"datalist\", _hoisted_79, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(specialModelOptions), (item) => {\n                                                                return (_openBlock(), _createElementBlock(\"option\", {\n                                                                    key: item,\n                                                                    value: item\n                                                                }, _toDisplayString(item), 9 /* TEXT, PROPS */, _hoisted_80));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_81, [\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"button\",\n                                                            class: \"ghost small\",\n                                                            disabled: _unref(specialModelFetchRunning),\n                                                            onClick: fetchSpecialModelOptions\n                                                        }, _toDisplayString(_unref(specialModelFetchRunning) ? '...' : 'NPC'), 9 /* TEXT, PROPS */, _hoisted_82),\n                                                        _createElementVNode(\"span\", _hoisted_83, _toDisplayString(_unref(specialModelOptions).length ? ` ${_unref(specialModelOptions).length} ` : 'NPC'), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_84, [\n                                                        _cache[133] || (_cache[133] = _createElementVNode(\"span\", null, \"NPC\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                                            \"onUpdate:modelValue\": _cache[49] || (_cache[49] = ($event) => ((_unref(settings).specialMemoryPrompt) = $event)),\n                                                            rows: \"4\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).specialMemoryPrompt]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_85, [\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[50] || (_cache[50] = ($event) => ((_unref(settings).specialMemoryUseVarApi) = $event)),\n                                                            type: \"checkbox\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelCheckbox, _unref(settings).specialMemoryUseVarApi]\n                                                        ]),\n                                                        _cache[134] || (_cache[134] = _createElementVNode(\"span\", null, \"NPCAPI\", -1 /* CACHED */))\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[135] || (_cache[135] = _createElementVNode(\"span\", null, \"NPCAPI URL\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[51] || (_cache[51] = ($event) => ((_unref(settings).specialMemoryVarApiUrl) = $event)),\n                                                            placeholder: \"https://your-api/npc-vars\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).specialMemoryVarApiUrl,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", null, [\n                                                        _cache[136] || (_cache[136] = _createElementVNode(\"span\", null, \"NPCAPI Key\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"input\", {\n                                                            \"onUpdate:modelValue\": _cache[52] || (_cache[52] = ($event) => ((_unref(settings).specialMemoryVarApiKey) = $event)),\n                                                            type: \"password\",\n                                                            placeholder: \"Bearer Token\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [\n                                                                _vModelText,\n                                                                _unref(settings).specialMemoryVarApiKey,\n                                                                void 0,\n                                                                { trim: true }\n                                                            ]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"label\", _hoisted_86, [\n                                                        _cache[137] || (_cache[137] = _createElementVNode(\"span\", null, \"NPCAPIJSON\", -1 /* CACHED */)),\n                                                        _withDirectives(_createElementVNode(\"textarea\", {\n                                                            \"onUpdate:modelValue\": _cache[53] || (_cache[53] = ($event) => ((_unref(settings).specialMemoryVarApiPayload) = $event)),\n                                                            rows: \"3\"\n                                                        }, null, 512 /* NEED_PATCH */), [\n                                                            [_vModelText, _unref(settings).specialMemoryVarApiPayload]\n                                                        ])\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_87, [\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"button\",\n                                                            onClick: saveSettings\n                                                        }, \"\"),\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"button\",\n                                                            class: \"ghost\",\n                                                            onClick: resetSession\n                                                        }, \"\"),\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"button\",\n                                                            class: \"ghost\",\n                                                            onClick: _cache[54] || (_cache[54] = ($event) => (showSummaryCenter.value = !_unref(showSummaryCenter)))\n                                                        }, _toDisplayString(_unref(showSummaryCenter) ? '' : ''), 1 /* TEXT */)\n                                                    ])\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (_unref(showSummaryCenter))\n                                                ? (_openBlock(), _createElementBlock(\"section\", _hoisted_88, [\n                                                    _createElementVNode(\"div\", _hoisted_89, [\n                                                        _cache[139] || (_cache[139] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_90, \" \" + _toDisplayString(_unref(memoryVault).length) + \"  \" + _toDisplayString(_unref(hiddenFloorUntil)), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_91, [\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"button\",\n                                                            class: \"ghost\",\n                                                            disabled: _unref(summaryRunning) || _unref(pending),\n                                                            onClick: runManualSummary\n                                                        }, _toDisplayString(_unref(summaryRunning) ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_92),\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"button\",\n                                                            class: \"ghost\",\n                                                            disabled: _unref(summaryRunning) || _unref(pending),\n                                                            onClick: runManualMegaSummary\n                                                        }, _toDisplayString(_unref(summaryRunning) ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_93),\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"button\",\n                                                            class: \"ghost\",\n                                                            onClick: clearMemoryVault\n                                                        }, \"\")\n                                                    ]),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(memoryVaultReversed), (entry) => {\n                                                        return (_openBlock(), _createElementBlock(\"article\", {\n                                                            key: entry.id,\n                                                            class: \"memory-item\"\n                                                        }, [\n                                                            _createElementVNode(\"header\", null, [\n                                                                _createElementVNode(\"strong\", null, \" \" + _toDisplayString(entry.floorStart) + \" - \" + _toDisplayString(entry.floorEnd), 1 /* TEXT */),\n                                                                _createElementVNode(\"span\", _hoisted_94, _toDisplayString(formatTs(entry.createdAt)) + \" / \" + _toDisplayString(entry.extraVarNote), 1 /* TEXT */)\n                                                            ]),\n                                                            _createElementVNode(\"pre\", null, _toDisplayString(entry.summary), 1 /* TEXT */)\n                                                        ]));\n                                                    }), 128 /* KEYED_FRAGMENT */)),\n                                                    (!_unref(memoryVault).length)\n                                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_95, \" \" + _toDisplayString(_unref(settings).summaryFloorsPerRun) + \" \", 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true),\n                                                    _createElementVNode(\"div\", _hoisted_96, [\n                                                        _cache[140] || (_cache[140] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_97, \" \" + _toDisplayString(_unref(megaMemoryVault).length) + \" \", 1 /* TEXT */)\n                                                    ]),\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(megaMemoryVaultReversed), (entry) => {\n                                                        return (_openBlock(), _createElementBlock(\"article\", {\n                                                            key: entry.id,\n                                                            class: \"memory-item mega\"\n                                                        }, [\n                                                            _createElementVNode(\"header\", null, [\n                                                                _createElementVNode(\"strong\", null, \" \" + _toDisplayString(entry.floorStart) + \" - \" + _toDisplayString(entry.floorEnd) + \"\", 1 /* TEXT */),\n                                                                _createElementVNode(\"span\", _hoisted_98, _toDisplayString(formatTs(entry.createdAt)) + \" / \" + _toDisplayString(entry.extraVarNote), 1 /* TEXT */)\n                                                            ]),\n                                                            _createElementVNode(\"pre\", null, _toDisplayString(entry.summary), 1 /* TEXT */)\n                                                        ]));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            _createElementVNode(\"section\", _hoisted_99, [\n                                                _createElementVNode(\"button\", {\n                                                    type: \"button\",\n                                                    disabled: _unref(interactionLocked),\n                                                    onClick: _cache[55] || (_cache[55] = ($event) => (sendQuick('')))\n                                                }, \"\", 8 /* PROPS */, _hoisted_100),\n                                                _createElementVNode(\"button\", {\n                                                    type: \"button\",\n                                                    disabled: _unref(interactionLocked),\n                                                    onClick: _cache[56] || (_cache[56] = ($event) => (sendQuick('')))\n                                                }, \"\", 8 /* PROPS */, _hoisted_101),\n                                                _createElementVNode(\"button\", {\n                                                    type: \"button\",\n                                                    disabled: _unref(interactionLocked),\n                                                    onClick: _cache[57] || (_cache[57] = ($event) => (sendQuick('')))\n                                                }, \"\", 8 /* PROPS */, _hoisted_102)\n                                            ]),\n                                            _createElementVNode(\"section\", _hoisted_103, [\n                                                _createElementVNode(\"div\", _hoisted_104, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(visibleMessages), (item) => {\n                                                        return (_openBlock(), _createElementBlock(\"article\", {\n                                                            key: item.id,\n                                                            class: _normalizeClass([\"msg\", `msg--${item.role}`])\n                                                        }, [\n                                                            _createElementVNode(\"header\", null, _toDisplayString(roleLabel(item.role)), 1 /* TEXT */),\n                                                            _createElementVNode(\"pre\", null, _toDisplayString(displayContent(item)), 1 /* TEXT */)\n                                                        ], 2 /* CLASS */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]),\n                                                _createElementVNode(\"form\", {\n                                                    class: \"composer\",\n                                                    onSubmit: _withModifiers(sendUserInput, [\"prevent\"])\n                                                }, [\n                                                    _withDirectives(_createElementVNode(\"textarea\", {\n                                                        \"onUpdate:modelValue\": _cache[58] || (_cache[58] = ($event) => (_isRef(draft) ? (draft).value = $event : null)),\n                                                        rows: \"3\",\n                                                        disabled: _unref(interactionLocked),\n                                                        placeholder: \"\"\n                                                    }, null, 8 /* PROPS */, _hoisted_105), [\n                                                        [_vModelText, _unref(draft)]\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_106, [\n                                                        _createElementVNode(\"span\", _hoisted_107, _toDisplayString(_unref(interactionLocked) ? _unref(lockHint) : _unref(modeHint)), 1 /* TEXT */),\n                                                        _createElementVNode(\"button\", {\n                                                            type: \"submit\",\n                                                            disabled: _unref(interactionLocked) || !_unref(draft).trim()\n                                                        }, \"\", 8 /* PROPS */, _hoisted_108)\n                                                    ])\n                                                ], 32 /* NEED_HYDRATION */)\n                                            ]),\n                                            _createElementVNode(\"section\", _hoisted_109, [\n                                                _createElementVNode(\"div\", _hoisted_110, [\n                                                    _cache[141] || (_cache[141] = _createElementVNode(\"strong\", null, \"NPC\", -1 /* CACHED */)),\n                                                    _createElementVNode(\"span\", _hoisted_111, \" \" + _toDisplayString(_unref(onstageNpcs).length) + \" / NPC \" + _toDisplayString(_unref(longtermNpcs).length), 1 /* TEXT */),\n                                                    _createElementVNode(\"button\", {\n                                                        type: \"button\",\n                                                        class: \"ghost small\",\n                                                        onClick: _cache[59] || (_cache[59] = ($event) => (showNpcPanel.value = !_unref(showNpcPanel)))\n                                                    }, _toDisplayString(_unref(showNpcPanel) ? 'NPC' : 'NPC'), 1 /* TEXT */)\n                                                ]),\n                                                (_unref(showNpcPanel))\n                                                    ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                                        _createElementVNode(\"div\", _hoisted_112, [\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                \"onUpdate:modelValue\": _cache[60] || (_cache[60] = ($event) => ((_unref(npcEditor).name) = $event)),\n                                                                placeholder: \"NPC\"\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [\n                                                                    _vModelText,\n                                                                    _unref(npcEditor).name,\n                                                                    void 0,\n                                                                    { trim: true }\n                                                                ]\n                                                            ]),\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                \"onUpdate:modelValue\": _cache[61] || (_cache[61] = ($event) => ((_unref(npcEditor).role) = $event)),\n                                                                placeholder: \"/\"\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [\n                                                                    _vModelText,\n                                                                    _unref(npcEditor).role,\n                                                                    void 0,\n                                                                    { trim: true }\n                                                                ]\n                                                            ]),\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                \"onUpdate:modelValue\": _cache[62] || (_cache[62] = ($event) => ((_unref(npcEditor).relation) = $event)),\n                                                                placeholder: \"/\"\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [\n                                                                    _vModelText,\n                                                                    _unref(npcEditor).relation,\n                                                                    void 0,\n                                                                    { trim: true }\n                                                                ]\n                                                            ]),\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                \"onUpdate:modelValue\": _cache[63] || (_cache[63] = ($event) => ((_unref(npcEditor).status) = $event)),\n                                                                placeholder: \"/\"\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [\n                                                                    _vModelText,\n                                                                    _unref(npcEditor).status,\n                                                                    void 0,\n                                                                    { trim: true }\n                                                                ]\n                                                            ]),\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                \"onUpdate:modelValue\": _cache[64] || (_cache[64] = ($event) => ((_unref(npcEditor).tags) = $event)),\n                                                                placeholder: \"/\"\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [\n                                                                    _vModelText,\n                                                                    _unref(npcEditor).tags,\n                                                                    void 0,\n                                                                    { trim: true }\n                                                                ]\n                                                            ]),\n                                                            _createElementVNode(\"label\", _hoisted_113, [\n                                                                _withDirectives(_createElementVNode(\"input\", {\n                                                                    \"onUpdate:modelValue\": _cache[65] || (_cache[65] = ($event) => ((_unref(npcEditor).toLongterm) = $event)),\n                                                                    type: \"checkbox\"\n                                                                }, null, 512 /* NEED_PATCH */), [\n                                                                    [_vModelCheckbox, _unref(npcEditor).toLongterm]\n                                                                ]),\n                                                                _cache[142] || (_cache[142] = _createElementVNode(\"span\", null, \"NPC\", -1 /* CACHED */))\n                                                            ]),\n                                                            _createElementVNode(\"button\", {\n                                                                type: \"button\",\n                                                                class: \"ghost\",\n                                                                onClick: addNpc\n                                                            }, \"NPC\")\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_114, [\n                                                            _createElementVNode(\"section\", null, [\n                                                                _cache[143] || (_cache[143] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(onstageNpcs), (npc) => {\n                                                                    return (_openBlock(), _createElementBlock(\"article\", {\n                                                                        key: npc.id,\n                                                                        class: \"npc-card\"\n                                                                    }, [\n                                                                        _createElementVNode(\"header\", null, [\n                                                                            _createElementVNode(\"strong\", null, _toDisplayString(npc.name), 1 /* TEXT */),\n                                                                            _createElementVNode(\"button\", {\n                                                                                type: \"button\",\n                                                                                class: \"ghost small\",\n                                                                                onClick: ($event) => (removeNpc(npc.id, 'onstage'))\n                                                                            }, \"\", 8 /* PROPS */, _hoisted_115)\n                                                                        ]),\n                                                                        _createElementVNode(\"p\", null, \"\" + _toDisplayString(npc.role), 1 /* TEXT */),\n                                                                        _createElementVNode(\"p\", null, \"\" + _toDisplayString(npc.relation), 1 /* TEXT */),\n                                                                        _createElementVNode(\"p\", null, \"\" + _toDisplayString(npc.status), 1 /* TEXT */),\n                                                                        _createElementVNode(\"p\", null, \"\" + _toDisplayString(npc.tags), 1 /* TEXT */)\n                                                                    ]));\n                                                                }), 128 /* KEYED_FRAGMENT */)),\n                                                                (!_unref(onstageNpcs).length)\n                                                                    ? (_openBlock(), _createElementBlock(\"p\", _hoisted_116, \"\"))\n                                                                    : _createCommentVNode(\"v-if\", true)\n                                                            ]),\n                                                            _createElementVNode(\"section\", null, [\n                                                                _cache[144] || (_cache[144] = _createElementVNode(\"h4\", null, \"NPC\", -1 /* CACHED */)),\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(longtermNpcs), (npc) => {\n                                                                    return (_openBlock(), _createElementBlock(\"article\", {\n                                                                        key: npc.id,\n                                                                        class: \"npc-card\"\n                                                                    }, [\n                                                                        _createElementVNode(\"header\", null, [\n                                                                            _createElementVNode(\"strong\", null, _toDisplayString(npc.name), 1 /* TEXT */),\n                                                                            _createElementVNode(\"button\", {\n                                                                                type: \"button\",\n                                                                                class: \"ghost small\",\n                                                                                onClick: ($event) => (removeNpc(npc.id, 'longterm'))\n                                                                            }, \"\", 8 /* PROPS */, _hoisted_117)\n                                                                        ]),\n                                                                        _createElementVNode(\"p\", null, \"\" + _toDisplayString(npc.role), 1 /* TEXT */),\n                                                                        _createElementVNode(\"p\", null, \"\" + _toDisplayString(npc.relation), 1 /* TEXT */),\n                                                                        _createElementVNode(\"p\", null, \"\" + _toDisplayString(npc.status), 1 /* TEXT */),\n                                                                        _createElementVNode(\"p\", null, \"\" + _toDisplayString(npc.tags), 1 /* TEXT */)\n                                                                    ]));\n                                                                }), 128 /* KEYED_FRAGMENT */)),\n                                                                (!_unref(longtermNpcs).length)\n                                                                    ? (_openBlock(), _createElementBlock(\"p\", _hoisted_118, \"NPC\"))\n                                                                    : _createCommentVNode(\"v-if\", true)\n                                                            ])\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_119, [\n                                                            _cache[145] || (_cache[145] = _createElementVNode(\"strong\", null, \"NPC\", -1 /* CACHED */)),\n                                                            _createElementVNode(\"span\", _hoisted_120, \" \" + _toDisplayString(_unref(npcAutoActions).length) + \" \", 1 /* TEXT */),\n                                                            _createElementVNode(\"button\", {\n                                                                type: \"button\",\n                                                                class: \"ghost small\",\n                                                                disabled: _unref(specialNpcRunning),\n                                                                onClick: _cache[66] || (_cache[66] = ($event) => (runSpecialMemoryNpcTurn('manual')))\n                                                            }, _toDisplayString(_unref(specialNpcRunning) ? '...' : ''), 9 /* TEXT, PROPS */, _hoisted_121),\n                                                            _createElementVNode(\"button\", {\n                                                                type: \"button\",\n                                                                class: \"ghost small\",\n                                                                onClick: _cache[67] || (_cache[67] = ($event) => (npcAutoPanelCollapsed.value = !_unref(npcAutoPanelCollapsed)))\n                                                            }, _toDisplayString(_unref(npcAutoPanelCollapsed) ? '' : ''), 1 /* TEXT */)\n                                                        ]),\n                                                        (!_unref(npcAutoPanelCollapsed))\n                                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_122, [\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(npcAutoActionsReversed), (item) => {\n                                                                    return (_openBlock(), _createElementBlock(\"article\", {\n                                                                        key: item.id,\n                                                                        class: \"memory-item\"\n                                                                    }, [\n                                                                        _createElementVNode(\"header\", null, [\n                                                                            _createElementVNode(\"strong\", null, _toDisplayString(item.name) + \" / \" + _toDisplayString(item.source), 1 /* TEXT */),\n                                                                            _createElementVNode(\"span\", _hoisted_123, _toDisplayString(formatTs(item.createdAt)) + \" / \" + _toDisplayString(item.extraVarNote), 1 /* TEXT */)\n                                                                        ]),\n                                                                        _createElementVNode(\"pre\", null, _toDisplayString(item.action), 1 /* TEXT */)\n                                                                    ]));\n                                                                }), 128 /* KEYED_FRAGMENT */)),\n                                                                (!_unref(npcAutoActions).length)\n                                                                    ? (_openBlock(), _createElementBlock(\"p\", _hoisted_124, \"\"))\n                                                                    : _createCommentVNode(\"v-if\", true)\n                                                            ]))\n                                                            : _createCommentVNode(\"v-if\", true)\n                                                    ], 64 /* STABLE_FRAGMENT */))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ])\n                                        ])\n                                    ])\n                                ], 64 /* STABLE_FRAGMENT */)),\n                (_unref(systemNotices).length || _unref(dbTask).active)\n                    ? (_openBlock(), _createElementBlock(\"section\", _hoisted_125, [\n                        (_unref(dbTask).active)\n                            ? (_openBlock(), _createElementBlock(\"article\", _hoisted_126, [\n                                _createElementVNode(\"header\", null, [\n                                    _cache[146] || (_cache[146] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", null, _toDisplayString(_unref(dbTask).completed ? '' : ''), 1 /* TEXT */)\n                                ]),\n                                (!_unref(dbTask).completed)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_127, _toDisplayString(_unref(dbTask).label) + \"   \" + _toDisplayString(_unref(dbTask).seconds) + \"  \", 1 /* TEXT */))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_128, _toDisplayString(_unref(dbTask).label) + \"  \", 1 /* TEXT */))\n                            ]))\n                            : _createCommentVNode(\"v-if\", true),\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(systemNotices), (n) => {\n                            return (_openBlock(), _createElementBlock(\"article\", {\n                                key: n.id,\n                                class: \"system-notice\"\n                            }, [\n                                _createElementVNode(\"header\", null, [\n                                    _cache[147] || (_cache[147] = _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"button\", {\n                                        type: \"button\",\n                                        class: \"ghost small\",\n                                        onClick: ($event) => (dismissNotice(n.id))\n                                    }, \"\", 8 /* PROPS */, _hoisted_129)\n                                ]),\n                                _createElementVNode(\"div\", null, _toDisplayString(n.content), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ], 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=00f979b1&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.29_typescript@6.0.0-dev.20250807__webpack@5.105.3/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-00f979b1\"]])\n\nexport default __exports__","import App from './App.vue';\nfunction ensureStandaloneRoot() {\n    let root = document.querySelector('#app');\n    if (!root) {\n        root = document.createElement('div');\n        root.id = 'app';\n        document.body.append(root);\n    }\n    return root;\n}\nfunction isLikelyTavernEnv() {\n    return typeof window !== 'undefined' && typeof window.SillyTavern !== 'undefined' && !!$('#chat').length;\n}\nasync function mountInTavern() {\n    try {\n        const { mountStreamingMessages } = await import('@util/streaming');\n        const { unmount } = mountStreamingMessages(() => createApp(App, { mode: 'embedded' }));\n        $(window).on('pagehide', () => unmount());\n        return true;\n    }\n    catch (error) {\n        console.warn('[] ', error);\n        return false;\n    }\n}\nasync function boot() {\n    if (isLikelyTavernEnv() && (await mountInTavern())) {\n        return;\n    }\n    ensureStandaloneRoot();\n    createApp(App, { mode: 'standalone' }).mount('#app');\n}\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => {\n        void boot();\n    });\n}\nelse {\n    void boot();\n}\n"],"names":["teleportStyle","append_to","$div","$","attr","getScriptId","append","document","clone","appendTo","destroy","remove","uuidv4","replace","c","r","Math","random","toString","mountStreamingMessages","creator","options","host","filter","prefix","states","Map","has_stoped","destroyIfInvalid","message_id","min_message_id","Number","first","_","inRange","SillyTavern","chat","length","get","destroyAllInvalid","keys","forEach","renderOneMessage","async","stream_message","message","getChatMessages","$message_element","$mes_text","find","addClass","$host","state","data","during_streaming","Boolean","$mes_streaming","css","padding","insertAfter","script_id","frameborder","srcdoc","reactive","host_id","app","provide","on","this","contentDocument","head","mount","body","observer","MutationObserver","$edit_textarea","parent","is","removeClass","observe","childList","set","$th_streaming","unmount","children","disconnect","delete","renderAllMessage","destroy_all","Promise","all","map","_index","node","isNaN","trigger_event","eventEmit","tavern_events","CHARACTER_MESSAGE_RENDERED","stop_list","scopedEventOn","event","listener","push","eventMakeFirst","errorCatched","stop","eventOn","MESSAGE_EDITED","MESSAGE_DELETED","MORE_MESSAGES_LOADED","setTimeout","STREAM_TOKEN_RECEIVED","exports","sfc","props","target","__vccOpts","key","val","module","Vue","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","o","Object","defineProperty","enumerable","obj","prop","prototype","hasOwnProperty","call","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","id","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68","_hoisted_69","_hoisted_70","_hoisted_71","_hoisted_72","_hoisted_73","_hoisted_74","_hoisted_75","_hoisted_76","_hoisted_77","_hoisted_78","_hoisted_79","_hoisted_80","_hoisted_81","_hoisted_82","_hoisted_83","_hoisted_84","_hoisted_85","_hoisted_86","_hoisted_87","_hoisted_88","_hoisted_89","_hoisted_90","_hoisted_91","_hoisted_92","_hoisted_93","_hoisted_94","_hoisted_95","_hoisted_96","_hoisted_97","_hoisted_98","_hoisted_99","_hoisted_100","_hoisted_101","_hoisted_102","_hoisted_103","_hoisted_104","_hoisted_105","_hoisted_106","_hoisted_107","_hoisted_108","_hoisted_109","_hoisted_110","_hoisted_111","_hoisted_112","_hoisted_113","_hoisted_114","_hoisted_115","_hoisted_116","_hoisted_117","_hoisted_118","_hoisted_119","_hoisted_120","_hoisted_121","_hoisted_122","_hoisted_123","_hoisted_124","_hoisted_125","_hoisted_126","_hoisted_127","_hoisted_128","_hoisted_129","storageKey","runtimeStorageKey","__name","mode","default","setup","__props","modeHint","computed","inTavern","window","rootRef","ref","isFullscreen","started","createDone","createPage","cheatMode","plotMode","xenoRouteMode","xenoRouteRole","showSettings","showSummaryCenter","showInventoryPanel","showNpcPanel","pending","dbLock","draft","nextId","currentPage","tavernSummary","systemNotices","dbTask","active","completed","label","seconds","professionOptions","warmaidTypeOptions","genderOptions","ageLimits","min","max","professionDescriptionMap","warmaidTypeDescriptionMap","createForm","name","profession","warmaidType","age","gender","background","backgroundTemplateMap","backgroundPresetOptions","backgroundPresetKey","humanAttrItems","desc","createHumanAttr","humanPointsLeft","values","reduce","sum","v","currentAgeRange","professionDescription","warmaidTypeDescription","autoBackgroundPresetKey","value","currentBackgroundPresetLabel","item","backgroundSummary","raw","trim","slice","resetPlayerResource","base","hpMax","mpMax","ap","getInitialResourceByBuild","playerResource","hp","mp","defaultSettings","autoFlipPage","useTavernPreset","baseUrl","apiKey","model","systemPrompt","autoSummaryEnabled","summaryFloorsPerRun","summaryUseCurrentApi","autoSummaryPrompt","summaryUseVarApi","summaryVarApiUrl","summaryVarApiKey","summaryVarApiPayload","megaSummaryEnabled","megaSummaryEvery","megaSummaryUseCurrentApi","megaSummaryPrompt","megaSummaryUseVarApi","megaSummaryVarApiUrl","megaSummaryVarApiKey","megaSummaryVarApiPayload","specialMemoryEnabled","specialMemoryNpcId","specialMemoryUseCurrentApi","specialMemoryBaseUrl","specialMemoryApiKey","specialMemoryModel","specialMemoryPrompt","specialMemoryUseVarApi","specialMemoryVarApiUrl","specialMemoryVarApiKey","specialMemoryVarApiPayload","settings","modelOptions","modelFetchRunning","specialModelOptions","specialModelFetchRunning","memoryVault","megaMemoryVault","onstageNpcs","longtermNpcs","inventoryItems","npcAutoActions","specialNpcRunning","npcAutoPanelCollapsed","npcEditor","role","relation","status","tags","toLongterm","inventoryEditor","count","note","summaryRunning","summaryLastFloor","hiddenFloorUntil","megaSummaryLastCount","lockHint","interactionLocked","injectedContext","inject","contextHint","playerBuildHint","attrs","join","route","memoryVaultHint","floorStart","floorEnd","summary","memoryVaultReversed","reverse","megaMemoryVaultReversed","npcAutoActionsReversed","allNpcs","selectedSpecialMemoryNpc","n","messages","content","pushMessage","sanitizeAssistantContent","String","rawTrimmed","normalizedRaw","m","tailAfterThink","includes","split","pop","contentMatch","match","cleaned","cleanedFallback","test","displayContent","dismissNotice","pushSystemNotice","Date","now","floor","unshift","toastr","info","dbTickTimer","startDbTask","clearInterval","setInterval","finishDbTask","pageRanges","starts","i","start","idx","end","visibleMessages","page","watch","range","immediate","localStorage","setItem","JSON","stringify","deep","npcs","some","saveRuntimeState","saveSettings","resetSession","pickString","source","pullFromTavern","st","presetName","getLoadedPresetName","preset","getPreset","chatConfig","chatCompletionSettings","getChatCompletionModel","should_stream","error","buildApiUrl","endsWith","buildModelsUrl","extractModelIds","payload","ids","Array","isArray","models","from","Set","sort","a","b","localeCompare","fetchModelOptions","url","headers","Authorization","response","fetch","method","ok","Error","json","fetchSpecialModelOptions","buildPayloadMessages","systemBlocks","entries","extractAssistantText","buildFloorTranscript","lines","fetchExtraVariablesByConfig","useVarApi","bodyText","text","requestSummaryText","userPrompt","useCurrentApi","generate","user_input","should_silence","stream","choices","requestTextByManualApi","buildRecentTranscript","floors","playableFloors","runSpecialMemoryNpcTurn","trigger","npc","extraVars","prompt","actionText","requestTextByApiConfig","action","npcId","createdAt","extraVarNote","maybeRunMegaSummary","force","threshold","trunc","allSummaryText","megaPrompt","last","runAutoSummaryForBlock","transcript","summaryPrompt","requestWithManualApi","answer","streamed","onDelta","reader","getReader","decoder","TextDecoder","buffer","done","read","decode","line","trimmed","startsWith","parsed","parse","delta","parseSseAndWrite","requestAi","lastUser","requestWithTavernPreset","floorsPerRun","nextTarget","maybeRunAutoSummary","sendUserInput","sendQuick","formatTs","ts","toLocaleString","clearMemoryVault","runManualSummary","runManualMegaSummary","addNpc","exist","next","assign","removeNpc","type","addInventoryItem","startSession","startNormalRoute","startXenoRoute","goCreatePageTwo","isFinite","goCreatePageThree","applyBackgroundPreset","finishCreate","getFullscreenElement","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","enterFullscreen","documentElement","fn","requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","syncFullscreenState","toggleFullscreen","doc","exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","onMounted","getItem","loadSettings","loadRuntimeState","eventName","addEventListener","onUnmounted","_ctx","_cache","ref_key","onClick","$event","placeholder","number","disabled","list","rows","entry","onSubmit","maxlength","readonly","boot","createApp","App","console","warn","mountInTavern","root","querySelector","createElement","ensureStandaloneRoot","readyState"],"sourceRoot":""}